<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>V2ray安装配置Vadminss、VLESS、XTLS教程 | Xizi's Blog</title><meta name=keywords content="V2ray"><meta name=description content="近期更新重点

V2Ray v4.27.0+新增支持VLESS新协议
V2Ray v4.29.0+新增支持XTLS新协议
Vadminss AEAD will be used when alterId is 0 in V2Ray v4.28.0+
安装脚本放废弃go.sh改用install-realese.sh
V2Ray v4.33.0移除了XTLS，建议使用V2Ray v4.32.1

详情参考

https://v2ray.com/
https://github.com/v2ray/v2ray-core
https://toutyrater.github.io/
https://guide.v2fly.org/
https://github.com/veekxt/v2ray-template
https://github.com/v2fly/v2ray-examples
https://www.v2fly.org/
https://github.com/rprx/v2ray-vless
https://github.com/v2fly/v2ray-core
https://github.com/XTLS/Xray-core

排名不分先后顺序 致敬开发者们的无私奉献

xray

https://github.com/XTLS/Xray-core
Install & Upgrade Xray-core and .dat files
bash <(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh)
Update geoip.dat and geosite.dat only
bash <(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-dat-release.sh)
Remove Xray, except json and logs
bash <(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh) --remove
成功安装后会提示如下
# /etc/systemd/system/xray.service
[Unit]
Description=Xray Service
Documentation=https://github.com/xtls
After=network.target nss-lookup.target

[Service]
User=nobody
CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE
NoNewPrivileges=true
ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json
Restart=on-failure
RestartPreventExitStatus=23

[Install]
WantedBy=multi-user.target

# /etc/systemd/system/xray.service.d/10-donot_touch_single_conf.conf
# In case you have a good reason to do so, duplicate this file in the same directory and make your customizes there.
# Or all changes you made will be lost!  # Refer: https://www.freedesktop.org/software/systemd/man/systemd.unit.html
[Service]
ExecStart=
ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json

installed: /usr/local/bin/xray
installed: /usr/local/share/xray/geoip.dat
installed: /usr/local/share/xray/geosite.dat
installed: /usr/local/etc/xray/config.json
installed: /var/log/xray/
installed: /var/log/xray/access.log
installed: /var/log/xray/error.log
installed: /etc/systemd/system/xray.service
installed: /etc/systemd/system/xray@.service
removed: /tmp/tmp.S3mHoPXvIj
info: Xray v1.1.2 is installed.
You may need to execute a command to remove dependent software: apt purge curl unzip
Please execute the command: systemctl enable xray; systemctl start xray
解决SSL证书权限不足"><meta name=author content="admin"><link rel=canonical href=https://567899.xyz/post/v2ray/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.7b3992f7b4f9ee4ae9431996141cd91083cdbffc8db56955d4cdcd798a156db7.css integrity="sha256-ezmS97T57krpQxmWFBzZEIPNv/yNtWlV1M3NeYoVbbc=" rel="preload stylesheet" as=style><link rel=icon href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://567899.xyz/post/v2ray/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://567899.xyz/post/v2ray/"><meta property="og:site_name" content="Xizi's Blog"><meta property="og:title" content="V2ray安装配置Vadminss、VLESS、XTLS教程"><meta property="og:description" content="近期更新重点
V2Ray v4.27.0+新增支持VLESS新协议 V2Ray v4.29.0+新增支持XTLS新协议 Vadminss AEAD will be used when alterId is 0 in V2Ray v4.28.0+ 安装脚本放废弃go.sh改用install-realese.sh V2Ray v4.33.0移除了XTLS，建议使用V2Ray v4.32.1 详情参考
https://v2ray.com/ https://github.com/v2ray/v2ray-core https://toutyrater.github.io/ https://guide.v2fly.org/ https://github.com/veekxt/v2ray-template https://github.com/v2fly/v2ray-examples https://www.v2fly.org/ https://github.com/rprx/v2ray-vless https://github.com/v2fly/v2ray-core https://github.com/XTLS/Xray-core 排名不分先后顺序 致敬开发者们的无私奉献
xray https://github.com/XTLS/Xray-core
Install & Upgrade Xray-core and .dat files bash <(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh) Update geoip.dat and geosite.dat only bash <(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-dat-release.sh) Remove Xray, except json and logs bash <(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh) --remove 成功安装后会提示如下
# /etc/systemd/system/xray.service [Unit] Description=Xray Service Documentation=https://github.com/xtls After=network.target nss-lookup.target [Service] User=nobody CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE NoNewPrivileges=true ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json Restart=on-failure RestartPreventExitStatus=23 [Install] WantedBy=multi-user.target # /etc/systemd/system/xray.service.d/10-donot_touch_single_conf.conf # In case you have a good reason to do so, duplicate this file in the same directory and make your customizes there. # Or all changes you made will be lost! # Refer: https://www.freedesktop.org/software/systemd/man/systemd.unit.html [Service] ExecStart= ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json installed: /usr/local/bin/xray installed: /usr/local/share/xray/geoip.dat installed: /usr/local/share/xray/geosite.dat installed: /usr/local/etc/xray/config.json installed: /var/log/xray/ installed: /var/log/xray/access.log installed: /var/log/xray/error.log installed: /etc/systemd/system/xray.service installed: /etc/systemd/system/xray@.service removed: /tmp/tmp.S3mHoPXvIj info: Xray v1.1.2 is installed. You may need to execute a command to remove dependent software: apt purge curl unzip Please execute the command: systemctl enable xray; systemctl start xray 解决SSL证书权限不足"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-09-28T01:37:56+08:00"><meta property="article:modified_time" content="2020-09-28T01:37:56+08:00"><meta property="article:tag" content="V2ray"><meta property="og:image" content="https://567899.xyz/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://567899.xyz/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="V2ray安装配置Vadminss、VLESS、XTLS教程"><meta name=twitter:description content="近期更新重点

V2Ray v4.27.0+新增支持VLESS新协议
V2Ray v4.29.0+新增支持XTLS新协议
Vadminss AEAD will be used when alterId is 0 in V2Ray v4.28.0+
安装脚本放废弃go.sh改用install-realese.sh
V2Ray v4.33.0移除了XTLS，建议使用V2Ray v4.32.1

详情参考

https://v2ray.com/
https://github.com/v2ray/v2ray-core
https://toutyrater.github.io/
https://guide.v2fly.org/
https://github.com/veekxt/v2ray-template
https://github.com/v2fly/v2ray-examples
https://www.v2fly.org/
https://github.com/rprx/v2ray-vless
https://github.com/v2fly/v2ray-core
https://github.com/XTLS/Xray-core

排名不分先后顺序 致敬开发者们的无私奉献

xray

https://github.com/XTLS/Xray-core
Install & Upgrade Xray-core and .dat files
bash <(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh)
Update geoip.dat and geosite.dat only
bash <(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-dat-release.sh)
Remove Xray, except json and logs
bash <(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh) --remove
成功安装后会提示如下
# /etc/systemd/system/xray.service
[Unit]
Description=Xray Service
Documentation=https://github.com/xtls
After=network.target nss-lookup.target

[Service]
User=nobody
CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE
NoNewPrivileges=true
ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json
Restart=on-failure
RestartPreventExitStatus=23

[Install]
WantedBy=multi-user.target

# /etc/systemd/system/xray.service.d/10-donot_touch_single_conf.conf
# In case you have a good reason to do so, duplicate this file in the same directory and make your customizes there.
# Or all changes you made will be lost!  # Refer: https://www.freedesktop.org/software/systemd/man/systemd.unit.html
[Service]
ExecStart=
ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json

installed: /usr/local/bin/xray
installed: /usr/local/share/xray/geoip.dat
installed: /usr/local/share/xray/geosite.dat
installed: /usr/local/etc/xray/config.json
installed: /var/log/xray/
installed: /var/log/xray/access.log
installed: /var/log/xray/error.log
installed: /etc/systemd/system/xray.service
installed: /etc/systemd/system/xray@.service
removed: /tmp/tmp.S3mHoPXvIj
info: Xray v1.1.2 is installed.
You may need to execute a command to remove dependent software: apt purge curl unzip
Please execute the command: systemctl enable xray; systemctl start xray
解决SSL证书权限不足"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://567899.xyz/post/"},{"@type":"ListItem","position":2,"name":"V2ray安装配置Vadminss、VLESS、XTLS教程","item":"https://567899.xyz/post/v2ray/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"V2ray安装配置Vadminss、VLESS、XTLS教程","name":"V2ray安装配置Vadminss、VLESS、XTLS教程","description":"近期更新重点\nV2Ray v4.27.0+新增支持VLESS新协议 V2Ray v4.29.0+新增支持XTLS新协议 Vadminss AEAD will be used when alterId is 0 in V2Ray v4.28.0+ 安装脚本放废弃go.sh改用install-realese.sh V2Ray v4.33.0移除了XTLS，建议使用V2Ray v4.32.1 详情参考\nhttps://v2ray.com/ https://github.com/v2ray/v2ray-core https://toutyrater.github.io/ https://guide.v2fly.org/ https://github.com/veekxt/v2ray-template https://github.com/v2fly/v2ray-examples https://www.v2fly.org/ https://github.com/rprx/v2ray-vless https://github.com/v2fly/v2ray-core https://github.com/XTLS/Xray-core 排名不分先后顺序 致敬开发者们的无私奉献\nxray https://github.com/XTLS/Xray-core\nInstall \u0026amp; Upgrade Xray-core and .dat files bash \u0026lt;(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh) Update geoip.dat and geosite.dat only bash \u0026lt;(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-dat-release.sh) Remove Xray, except json and logs bash \u0026lt;(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh) --remove 成功安装后会提示如下\n# /etc/systemd/system/xray.service [Unit] Description=Xray Service Documentation=https://github.com/xtls After=network.target nss-lookup.target [Service] User=nobody CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE NoNewPrivileges=true ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json Restart=on-failure RestartPreventExitStatus=23 [Install] WantedBy=multi-user.target # /etc/systemd/system/xray.service.d/10-donot_touch_single_conf.conf # In case you have a good reason to do so, duplicate this file in the same directory and make your customizes there. # Or all changes you made will be lost! # Refer: https://www.freedesktop.org/software/systemd/man/systemd.unit.html [Service] ExecStart= ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json installed: /usr/local/bin/xray installed: /usr/local/share/xray/geoip.dat installed: /usr/local/share/xray/geosite.dat installed: /usr/local/etc/xray/config.json installed: /var/log/xray/ installed: /var/log/xray/access.log installed: /var/log/xray/error.log installed: /etc/systemd/system/xray.service installed: /etc/systemd/system/xray@.service removed: /tmp/tmp.S3mHoPXvIj info: Xray v1.1.2 is installed. You may need to execute a command to remove dependent software: apt purge curl unzip Please execute the command: systemctl enable xray; systemctl start xray 解决SSL证书权限不足\n","keywords":["V2ray"],"articleBody":"近期更新重点\nV2Ray v4.27.0+新增支持VLESS新协议 V2Ray v4.29.0+新增支持XTLS新协议 Vadminss AEAD will be used when alterId is 0 in V2Ray v4.28.0+ 安装脚本放废弃go.sh改用install-realese.sh V2Ray v4.33.0移除了XTLS，建议使用V2Ray v4.32.1 详情参考\nhttps://v2ray.com/ https://github.com/v2ray/v2ray-core https://toutyrater.github.io/ https://guide.v2fly.org/ https://github.com/veekxt/v2ray-template https://github.com/v2fly/v2ray-examples https://www.v2fly.org/ https://github.com/rprx/v2ray-vless https://github.com/v2fly/v2ray-core https://github.com/XTLS/Xray-core 排名不分先后顺序 致敬开发者们的无私奉献\nxray https://github.com/XTLS/Xray-core\nInstall \u0026 Upgrade Xray-core and .dat files bash \u003c(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh) Update geoip.dat and geosite.dat only bash \u003c(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-dat-release.sh) Remove Xray, except json and logs bash \u003c(curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh) --remove 成功安装后会提示如下\n# /etc/systemd/system/xray.service [Unit] Description=Xray Service Documentation=https://github.com/xtls After=network.target nss-lookup.target [Service] User=nobody CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE NoNewPrivileges=true ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json Restart=on-failure RestartPreventExitStatus=23 [Install] WantedBy=multi-user.target # /etc/systemd/system/xray.service.d/10-donot_touch_single_conf.conf # In case you have a good reason to do so, duplicate this file in the same directory and make your customizes there. # Or all changes you made will be lost! # Refer: https://www.freedesktop.org/software/systemd/man/systemd.unit.html [Service] ExecStart= ExecStart=/usr/local/bin/xray run -config /usr/local/etc/xray/config.json installed: /usr/local/bin/xray installed: /usr/local/share/xray/geoip.dat installed: /usr/local/share/xray/geosite.dat installed: /usr/local/etc/xray/config.json installed: /var/log/xray/ installed: /var/log/xray/access.log installed: /var/log/xray/error.log installed: /etc/systemd/system/xray.service installed: /etc/systemd/system/xray@.service removed: /tmp/tmp.S3mHoPXvIj info: Xray v1.1.2 is installed. You may need to execute a command to remove dependent software: apt purge curl unzip Please execute the command: systemctl enable xray; systemctl start xray 解决SSL证书权限不足\nsed -i 's/User=nobody/User=root/' /etc/systemd/system/xray.service sed -i 's/User=nobody/User=root/' /etc/systemd/system/xray@.service 编辑创建xray配置文件\nnano /usr/local/etc/xray/config.json 输入以下示范\n{ \"log\": { \"loglevel\": \"warning\" }, \"inbounds\": [ { \"port\": 443, \"protocol\": \"vless\", \"settings\": { \"clients\": [ { \"id\": \"\", // 填写你的 UUID \"flow\": \"xtls-rprx-direct\", \"level\": 0, \"email\": \"love@v2fly.org\" } ], \"decryption\": \"none\", \"fallbacks\": [ { \"dest\": 81 }, { \"path\": \"/websocket\", // 必须换成自定义的 PATH \"dest\": 1234, \"xver\": 1 } ] }, \"streamSettings\": { \"network\": \"tcp\", \"security\": \"xtls\", \"xtlsSettings\": { \"alpn\": [ \"http/1.1\" ], \"certificates\": [ { \"certificateFile\": \"/etc/letsencrypt/live/example.com/fullchain.pem\", // 换成你的证书，绝对路径 \"keyFile\": \"/etc/letsencrypt/live/example.com/privkey.pem\" // 换成你的私钥，绝对路径 } ] } } }, { \"port\": 1234, \"listen\": \"127.0.0.1\", \"protocol\": \"vless\", \"settings\": { \"clients\": [ { \"id\": \"\", // 填写你的 UUID \"level\": 0, \"email\": \"love@v2fly.org\" } ], \"decryption\": \"none\" }, \"streamSettings\": { \"network\": \"ws\", \"security\": \"none\", \"wsSettings\": { \"acceptProxyProtocol\": true, // 提醒：若你用 Nginx/Caddy 等反代 WS，需要删掉这行 \"path\": \"/websocket\" // 必须换成自定义的 PATH，需要和分流的一致 } } }, { \"protocol\": \"shadowsocks\", \"port\": 1038, \"settings\": { \"method\": \"chacha20-ietf-poly1305\", \"password\": \"yourpassword###\", \"udp\": true } }, { \"protocol\": \"shadowsocks\", \"port\": 1039, \"settings\": { \"method\": \"aes-128-gcm\", \"password\": \"youpassword###\", \"udp\": true } }, { \"port\": 5678, \"protocol\": \"vmess\", \"settings\": { \"clients\": [ { \"id\": \"\", \"alterId\": 0 } ] }, \"streamSettings\": { \"network\": \"kcp\", \"security\": \"aes-128-gcm\", \"kcpSettings\": { \"mtu\": 1350, \"tti\": 20, \"uplinkCapacity\": 5, \"downlinkCapacity\": 100, \"congestion\": false, \"readBufferSize\": 1, \"writeBufferSize\": 1, \"header\": { \"type\": \"none\" }, \"seed\": \"Password###\" } } } ], \"outbounds\": [ { \"protocol\": \"freedom\" } ] } wget -O /usr/local/etc/xray/config.json https://567899.xyz/uploads/xray-server-config.json 替换自己的UUID和域名\nsed -i 's/\"\"/\"UUID\"/' /usr/local/etc/xray/config.json sed -i 's/example.com/你的域名/' /usr/local/etc/xray/config.json 启动xray\nsystemctl enable xray systemctl start xray 解决IP谷歌搜索人机验证码 warp双栈，v4v6出口全部由warp接管 bash \u003c(curl -fsSL https://raw.githubusercontent.com/P3TERX/warp.sh/main/warp.sh) d 添加v4出口，v4出口warp接管 bash \u003c(curl -fsSL https://raw.githubusercontent.com/P3TERX/warp.sh/main/warp.sh) 4 添加v6出口，v6出口warp接管，需要在扶墙配置文件里指定google走v6 bash \u003c(curl -fsSL https://raw.githubusercontent.com/P3TERX/warp.sh/main/warp.sh) 6 然后编辑/usr/local/etc/xray/config.json修改替换outbounds和routing为以下内容\n\"outbounds\": [ { \"tag\":\"IP4_out\", \"protocol\": \"freedom\", \"settings\": {} }, { \"tag\":\"IP6_out\", \"protocol\": \"freedom\", \"settings\": { \"domainStrategy\": \"UseIPv6\" // 指定使用 IPv6 } } ], \"routing\": { \"rules\": [ { \"type\": \"field\", \"outboundTag\": \"IP6_out\", \"domain\": [\"domain:www.google.com\"] // google走 IPv6 }, { \"type\": \"field\", \"outboundTag\": \"IP4_out\", \"network\": \"udp,tcp\"// 其余走 IPv4 } ] } 点击下载完整的配置文件示范\n重启VPS查看效果\nnginx配置示范\nserver { listen 80; listen [::]:80; server_name example.com; root /var/www/example.com; index index.html index.htm index.php; #return 301 https://$server_name$request_uri; } server { listen 81; listen [::]:81; server_name example.com; root /var/www/example.com; index index.html index.htm index.php; #php location ~ \\.php$ { include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.3-fpm.sock; } } 安装V2ray 安裝和更新 V2Ray\n#安裝執行檔和 .dat 資料檔 curl -LROJ https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-release.sh bash install-release.sh 安裝最新發行的 geoip.dat 和 geosite.dat\n#只更新 .dat 資料檔 curl -LROJ https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-dat-release.sh bash install-dat-release.sh 移除 V2Ray\nbash install-release.sh --remove 指定版本安装示范\nbash install-release.sh --version v4.32.1 完成安装会提示如下\n[Service] ExecStart= ExecStart=/usr/local/bin/v2ray -config /usr/local/etc/v2ray/%i.json installed: /usr/local/bin/v2ray installed: /usr/local/bin/v2ctl installed: /usr/local/share/v2ray/geoip.dat installed: /usr/local/share/v2ray/geosite.dat installed: /usr/local/etc/v2ray/config.json installed: /var/log/v2ray/ installed: /var/log/v2ray/access.log installed: /var/log/v2ray/error.log installed: /etc/systemd/system/v2ray.service installed: /etc/systemd/system/v2ray@.service removed: /tmp/tmp.MMsycHU0KG info: V2Ray v4.29.0 is installed. You may need to execute a command to remove dependent software: apt purge curl unzip Please execute the command: systemctl enable v2ray; systemctl start v2ray V2ray在使用VLESS时证书权限的解决办法 使用證書時權限不足 会导致套用模板后V2ray无法启动且无错误日志\n简单粗暴的解决方法是编辑修改/etc/systemd/system/v2ray.service找到User=nobody修改为User=root\nsed -i 's/User=nobody/User=root/' /etc/systemd/system/v2ray.service 详情参考使用證書時權限不足\n编辑配置文件 uuid可以通过\ncat /proc/sys/kernel/random/uuid 或者\nv2ctl uuid 随机生成\n测试配置文件是否错误\nv2ray -test -config=config.json 推荐组合模式 VLESS TCP XTLS 极致性能，超低的CPU占用，在硬路由器，手机上表现突出\nVLESS over WS with TLS CDN 服务器公网IP被xxoo了就能套娃使用\nVmess KCP udp2raw 在高丢包、高延迟、网络线路不佳的情况表现突出\nV2Ray服务端配置文件 客户端可以同时通过下列方式连接到服务器，其中 WS 都可以通过 CDN\nVLESS over TCP with XTLS VLESS over TCP with TLS VLESS over WS with TLS VLESS over WS with TLS CDN shadowsocks 编辑修改/usr/local/etc/v2ray/config.json替换成以下内容\n{ \"log\": { \"loglevel\": \"warning\" }, \"inbounds\": [ { \"port\": 443, \"protocol\": \"vless\", \"settings\": { \"clients\": [ { \"id\": \"\", // 填写你的 UUID \"flow\": \"xtls-rprx-origin\", \"level\": 0, \"email\": \"love@v2fly.org\" } ], \"decryption\": \"none\", \"fallbacks\": [ { \"dest\": \"/dev/shm/default.sock\", \"xver\": 1 }, { \"alpn\": \"h2\", \"dest\": \"/dev/shm/h2c.sock\", \"xver\": 1 }, { \"path\": \"/websocket\", // 必须换成自定义的 PATH \"dest\": 1234, \"xver\": 1 } ] }, \"streamSettings\": { \"network\": \"tcp\", \"security\": \"xtls\", \"xtlsSettings\": { \"alpn\": [ \"h2\", \"http/1.1\" ], \"certificates\": [ { \"certificateFile\": \"/path/to/fullchain.crt\", // 换成你的证书，绝对路径 \"keyFile\": \"/path/to/private.key\" // 换成你的私钥，绝对路径 } ] } } }, { \"port\": 1234, \"listen\": \"127.0.0.1\", \"protocol\": \"vless\", \"settings\": { \"clients\": [ { \"id\": \"\", // 填写你的 UUID \"level\": 0, \"email\": \"love@v2fly.org\" } ], \"decryption\": \"none\" }, \"streamSettings\": { \"network\": \"ws\", \"security\": \"none\", \"wsSettings\": { \"acceptProxyProtocol\": true, // 提醒：若你用 Nginx/Caddy 等反代 WS，需要删掉这行 \"path\": \"/websocket\" // 必须换成自定义的 PATH，需要和分流的一致 } } }, { \"protocol\": \"shadowsocks\", \"port\": 1038, \"settings\": { \"method\": \"chacha20-ietf-poly1305\", \"password\": \"yourpassword\", \"udp\": true } }, { \"protocol\": \"shadowsocks\", \"port\": 1039, \"settings\": { \"method\": \"aes-128-gcm\", \"password\": \"youpassword\", \"udp\": true } }, { \"port\": 7777, \"protocol\": \"vmess\", \"settings\": { \"clients\": [ { \"id\": \"\", // 填写你的 UUID \"alterId\": 0 } ] }, \"streamSettings\": { \"network\": \"kcp\", \"security\": \"aes-128-gcm\", \"kcpSettings\": { \"mtu\": 1350, \"tti\": 20, \"uplinkCapacity\": 5, \"downlinkCapacity\": 100, \"congestion\": false, \"readBufferSize\": 1, \"writeBufferSize\": 1, \"header\": { \"type\": \"none\" }, \"seed\": \"Password\" } } } ], \"outbounds\": [ { \"protocol\": \"freedom\" } ] } V2ray v4.31.0+可以更改xtls-rprx-origin为xtls-rprx-direct\nsed -i 's/xtls-rprx-origin/xtls-rprx-direct/' /usr/local/etc/v2ray/config.json 替换自己的UUID\nsed -i 's/\"id\": \"\"/\"id\": \"这里替换成你的UUID值\"/' /usr/local/etc/v2ray/config.json 配置Nginx server { listen unix:/dev/shm/default.sock proxy_protocol; listen unix:/dev/shm/h2c.sock http2 proxy_protocol; server_name example.com; root /var/www/example.com; index index.html index.htm index.php; #php location ~ \\.php$ { include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.3-fpm.sock; } } server { listen 80; listen [::]:80; server_name example.com; root /var/www/example.com; index index.html index.htm index.php; return 301 https://$server_name$request_uri; } 客户端连接 VLESS \u0026 TCP \u0026 XTLS { \"log\": { \"loglevel\": \"warning\" }, \"inbounds\": [ { \"port\": 10800, \"listen\": \"127.0.0.1\", \"protocol\": \"socks\", \"settings\": { \"udp\": true } } ], \"outbounds\": [ { \"protocol\": \"vless\", \"settings\": { \"vnext\": [ { \"address\": \"example.com\", // 换成你的域名或服务器 IP（发起请求时无需解析域名了） \"port\": 443, \"users\": [ { \"id\": \"\", // 填写你的 UUID \"flow\": \"xtls-rprx-origin\", \"encryption\": \"none\", \"level\": 0 } ] } ] }, \"streamSettings\": { \"network\": \"tcp\", \"security\": \"xtls\", // 需要使用 XTLS \"xtlsSettings\": { \"serverName\": \"example.com\" // 换成你的域名 } } } ] } vless_ws_tls.json { \"log\": { \"loglevel\": \"warning\" }, \"inbounds\": [ { \"port\": 10800, \"listen\": \"127.0.0.1\", \"protocol\": \"socks\", \"settings\": { \"udp\": true } } ], \"outbounds\": [ { \"protocol\": \"vless\", \"settings\": { \"vnext\": [ { \"address\": \"example.com\", // 换成你的域名或服务器 IP（发起请求时无需解析域名了） \"port\": 443, \"users\": [ { \"id\": \"\", // 填写你的 UUID \"encryption\": \"none\", \"level\": 0 } ] } ] }, \"streamSettings\": { \"network\": \"ws\", \"security\": \"tls\", \"tlsSettings\": { \"serverName\": \"example.com\" // 换成你的域名 }, \"wsSettings\": { \"path\": \"/websocket\" // 必须换成自定义的 PATH，需要和服务端的一致 } } } ] } vmess_ws_tls.json { \"log\": { \"loglevel\": \"warning\" }, \"inbounds\": [ { \"port\": 10800, \"listen\": \"127.0.0.1\", \"protocol\": \"socks\", \"settings\": { \"udp\": true } } ], \"outbounds\": [ { \"protocol\": \"vmess\", \"settings\": { \"vnext\": [ { \"address\": \"example.com\", // 换成你的域名或服务器 IP（发起请求时无需解析域名了） \"port\": 443, \"users\": [ { \"id\": \"\", // 填写你的 UUID \"security\": \"none\", \"level\": 0 } ] } ] }, \"streamSettings\": { \"network\": \"ws\", \"security\": \"tls\", \"tlsSettings\": { \"serverName\": \"example.com\" // 换成你的域名 }, \"wsSettings\": { \"path\": \"/vmessws\" // 必须换成自定义的 PATH，需要和服务端的一致 } } } ] } VLESS-H2C-Caddy2 注意： 目前仅 caddy2 的 v2.2.0-rc.1 版及以后完美支持 v2ray 的 H2C,实现 H2(HTTP/2)应用。\nV2ray配置文件\n{ \"log\": { \"loglevel\": \"none\" }, \"inbounds\": [ { \"sniffing\": { \"enabled\": true, \"destOverride\": [\"http\",\"tls\"] }, \"listen\": \"127.0.0.1\", \"port\": 10443, \"tag\": \"vless-in\", \"protocol\": \"vless\", \"settings\": { \"clients\": [ { \"id\": \"\", // uuid \"level\": 0 } ], \"decryption\": \"none\" }, \"streamSettings\": { \"network\": \"h2\", \"security\": \"none\", \"httpSettings\": { \"path\": \"/path\", \"host\": [ \"\" ] } } } ], \"outbounds\": [ { \"protocol\": \"freedom\", \"settings\": { }, \"tag\": \"direct\" }, { \"protocol\": \"blackhole\", \"settings\": { }, \"tag\": \"block\" } ], \"dns\": { \"servers\": [ \"https://cloudflare-dns.com/dns-query\", \"https://dns.google/dns-query\" ] }, \"routing\": { \"domainStrategy\": \"AsIs\", \"rules\": [ { \"type\": \"field\", \"inboundTag\": [ \"vless-in\" ], \"outboundTag\": \"direct\" }, { \"type\": \"field\", \"outboundTag\": \"block\", \"protocol\": [ \"bittorrent\" ] } ] } } Caddy2的Caddyfile\nexample.com { encode zstd gzip root * /usr/share/caddy/example.com file_server tls admin@example.com { protocols tls1.3 curves x25519 alpn h2 } header { Strict-Transport-Security max-age=31536000; X-Content-Type-Options nosniff X-Frame-Options DENY Referrer-Policy no-referrer-when-downgrade } reverse_proxy /v2ray?id=v2ray 127.0.0.1:10443 { header_up Host {http.request.host} header_up X-Real-IP {http.request.remote} header_up X-Forwarded-For {http.request.remote} header_up X-Forwarded-Port {http.request.port} header_up X-Forwarded-Proto {http.request.scheme} header_up Connection {http.request.header.Connection} header_up Upgrade {http.request.header.Upgrade} transport http { versions h2c } } } 客户端\n{ \"log\":{}, \"inbounds\":[ { \"port\":\"1080\", \"protocol\":\"socks\", \"settings\":{ \"auth\":\"noauth\", \"udp\":true } }, { \"port\":\"1081\", \"protocol\":\"http\", \"settings\":{} } ], \"outbounds\":[ { \"protocol\":\"vless\", \"settings\":{ \"vnext\":[ { \"address\":\"example.com\", \"port\":443, \"users\":[ { \"id\":\"\", \"encryption\":\"none\" } ] } ] }, \"streamSettings\":{ \"network\":\"h2\", \"security\":\"tls\", \"httpSettings\":{ \"host\":[ \"example.com\" ], \"path\":\"/path\" } } }, { \"tag\":\"direct\", \"protocol\":\"freedom\", \"settings\":{} }, { \"tag\":\"blocked\", \"protocol\":\"blackhole\", \"settings\":{} } ], \"routing\":{ \"domainStrategy\":\"IPOnDemand\", \"rules\":[ { \"type\":\"field\", \"ip\":[ \"geoip:private\" ], \"outboundTag\":\"direct\" } ] } } udp2raw vmess kcp udp2raw-tunnel\n下载udp2raw-tunnel\nudp2raw服务端设置(Debain,Ubuntu,Centos) wget https://github.com/wangyu-/udp2raw-tunnel/releases/download/20200818.0/udp2raw_binaries.tar.gz tar -zxvf udp2raw_binaries.tar.gz mv udp2raw_amd64 /usr/bin/udp2raw 运行 假设你有一个server，ip为44.55.66.77，有一个服务监听在udp 7777端口。 假设你本地的主机到44.55.66.77的UDP流量被屏蔽了，或者被qos了\n在server端运行:\nudp2raw -s -l0.0.0.0:4096 -r127.0.0.1:7777 -k \"passwd\" --raw-mode faketcp --cipher-mode xor -a (以上例子需要用root账号运行。 用非root运行udp2raw需要一些额外的步骤，具体方法请看 这个 链接。用非root运行更安全)\nudp2raw创建开机自动启动服务 echo \"[Unit] Description=udp2raw server After=network.service [Service] Type=simple User=root Group=root ExecStart=/usr/bin/udp2raw -s -l0.0.0.0:4096 -r127.0.0.1:7777 -k \"passwd\" --raw-mode faketcp --cipher-mode xor -a \u0026 PrivateTmp=true Restart=on-failure [Install] WantedBy=multi-user.target\" \u003e /etc/systemd/system/udp2raw.service udp2raw管理进程 systemctl daemon-reload systemctl enable udp2raw.service systemctl start udp2raw.service systemctl status udp2raw.service udp2raw在client端运行: ./udp2raw_amd64 -c -l0.0.0.0:3333 -r44.55.66.77:4096 -k \"passwd\" --raw-mode faketcp --cipher-mode xor -a android设备上运行udp2raw(arm cpu)\n照常运行udp2raw_arm，除了必须将-a选项更改为-g\n./udp2raw_arm -c -r 44.55.66.77:4096 -l 0.0.0.0:3333 -k1234 --cipher xor -g 从udp2raw的输出中找到生成的iptables规则，通过运行手动将其添加：\niptables -I INPUT -s 44.55.66.77/32 -p tcp -m tcp --sport 4096 -j DROP 在不使用-g命令的情况下运行udp2raw_ram\n./udp2raw_arm -c -r 44.55.66.77:4096 -l 0.0.0.0:3333 -k1234 --cipher xor 注意将44.55.66.77替换成你自己服务器的公网IP地址\nVmess KCP客户端V2ray配置 { \"inbounds\": [ { \"port\": 10808, \"listen\": \"127.0.0.1\", \"protocol\": \"socks\", \"settings\": { \"udp\": true } } ], \"outbounds\": [ { \"protocol\": \"vmess\", \"settings\": { \"vnext\": [ { \"address\": \"127.0.0.1\", \"port\": 3333, \"users\": [ { \"id\": \"\", // 填写你的 UUID \"alterId\": 0 } ] } ] }, \"streamSettings\": { \"network\": \"kcp\", \"security\": \"aes-128-gcm\", \"kcpSettings\": { \"mtu\": 1350, \"tti\": 20, \"uplinkCapacity\": 5, \"downlinkCapacity\": 100, \"congestion\": false, \"readBufferSize\": 1, \"writeBufferSize\": 1, \"header\": { \"type\": \"none\" }, \"seed\": \"Password\" } } } ] } 管理V2Ray进程 启动\nsystemctl start v2ray.service 停止\nsystemctl stop v2ray.service 状态\nsystemctl status v2ray.service 重启\nsystemctl restart v2ray.service 日常SSL证书申请的路径 宝塔Nginx的SSL证书路径 /www/server/panel/vhost/cert/example.com/fullchain.pem /www/server/panel/vhost/cert/example.com/privkey.pem Caddy1的SSL证书路径\n/etc/ssl/caddy/acme/acme-v02.api.letsencrypt.org/sites/example.com/example.com.crt /etc/ssl/caddy/acme/acme-v02.api.letsencrypt.org/sites/example.com/example.com.key Caddy2的SSL证书路径\n/var/lib/caddy/.local/share/caddy/certificates/acme-v02.api.letsencrypt.org-directory/example.com/example.com.crt /var/lib/caddy/.local/share/caddy/certificates/acme-v02.api.letsencrypt.org-directory/example.com/example.com.key Certbot的SSL证书路径\n/etc/letsencrypt/live/example.com/fullchain.pem /etc/letsencrypt/live/example.com/privkey.pem 如果需要配置多个域名证书，可以增加certificates值，例如\n\"certificates\": [ { \"certificateFile\": \"/path/to/tls1.crt\", // 换成你的证书，绝对路径 \"keyFile\": \"/path/to/tls1.key\" // 换成你的私钥，绝对路径 }, { \"certificateFile\": \"/path/to/tls2.crt\", // 换成你的证书，绝对路径 \"keyFile\": \"/path/to/tls2.key\" // 换成你的私钥，绝对路径 }, { \"certificateFile\": \"/path/to/tls3.crt\", // 换成你的证书，绝对路径 \"keyFile\": \"/path/to/tls3.key\" // 换成你的私钥，绝对路径 } ] 配置WEB服务器WebSocket的规则 在配置文件中添加v2ray的WebSocket的规则，然后重启在WEB服务器生效。\nCaddy2\n@v2ray_websocket { path /ray header Connection *Upgrade* header Upgrade websocket } reverse_proxy @v2ray_websocket localhost:22782 Caddy\nproxy /ray localhost:22782 { websocket header_upstream -Origin } Nginx\nlocation /ray { proxy_redirect off; proxy_pass http://127.0.0.1:22782; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \"upgrade\"; proxy_set_header Host $http_host; proxy_read_timeout 300s; } Apache\n把以下配置加到VirtualHost值\n","wordCount":"1957","inLanguage":"zh","image":"https://567899.xyz/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2020-09-28T01:37:56+08:00","dateModified":"2020-09-28T01:37:56+08:00","author":{"@type":"Person","name":"admin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://567899.xyz/post/v2ray/"},"publisher":{"@type":"Organization","name":"Xizi's Blog","logo":{"@type":"ImageObject","url":"https://567899.xyz/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://567899.xyz/ accesskey=h title="Xizi's Blog (Alt + H)"><img src=https://567899.xyz/apple-touch-icon.png alt aria-label=logo height=35>Xizi's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://567899.xyz/archives/ title=归档><span>归档</span></a></li><li><a href=https://567899.xyz/tags/ title=标签><span>标签</span></a></li><li><a href=https://567899.xyz/about/ title=关于><span>关于</span></a></li><li><a href=https://567899.xyz/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://567899.xyz/>主页</a>&nbsp;»&nbsp;<a href=https://567899.xyz/post/>Posts</a></div><h1 class="post-title entry-hint-parent">V2ray安装配置Vadminss、VLESS、XTLS教程</h1><div class=post-meta><span title='2020-09-28 01:37:56 +0800 +0800'>九月 28, 2020</span>&nbsp;·&nbsp;admin&nbsp;|&nbsp;<a href=https://github.com/pwwq/hugo-code/tree/master/content/post/v2ray.md rel="noopener noreferrer" target=_blank>编辑</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#xray>xray</a><ul><li><a href=#install--upgrade-xray-core-and-dat-files>Install & Upgrade Xray-core and .dat files</a></li><li><a href=#update-geoipdat-and-geositedat-only>Update geoip.dat and geosite.dat only</a></li><li><a href=#remove-xray-except-json-and-logs>Remove Xray, except json and logs</a></li></ul></li><li><a href=#解决ip谷歌搜索人机验证码>解决IP谷歌搜索人机验证码</a></li><li><a href=#安装v2ray>安装V2ray</a></li><li><a href=#v2ray在使用vless时证书权限的解决办法>V2ray在使用VLESS时证书权限的解决办法</a></li><li><a href=#编辑配置文件>编辑配置文件</a></li><li><a href=#推荐组合模式>推荐组合模式</a><ul><li><a href=#v2ray服务端配置文件>V2Ray服务端配置文件</a></li></ul></li><li><a href=#配置nginx>配置Nginx</a></li><li><a href=#客户端连接>客户端连接</a><ul><li><a href=#vless--tcp--xtls>VLESS & TCP & XTLS</a></li><li><a href=#vless_ws_tlsjson>vless_ws_tls.json</a></li><li><a href=#vmess_ws_tlsjson>vmess_ws_tls.json</a></li></ul></li><li><a href=#vless-h2c-caddy2>VLESS-H2C-Caddy2</a></li><li><a href=#udp2raw-vmess-kcp>udp2raw vmess kcp</a><ul><li><a href=#udp2raw服务端设置debainubuntucentos>udp2raw服务端设置(Debain,Ubuntu,Centos)</a></li><li><a href=#运行>运行</a></li><li><a href=#udp2raw创建开机自动启动服务>udp2raw创建开机自动启动服务</a></li><li><a href=#udp2raw管理进程>udp2raw管理进程</a></li><li><a href=#udp2raw在client端运行>udp2raw在client端运行:</a></li><li><a href=#vmess-kcp客户端v2ray配置>Vmess KCP客户端V2ray配置</a></li></ul></li><li><a href=#管理v2ray进程>管理V2Ray进程</a></li><li><a href=#日常ssl证书申请的路径>日常SSL证书申请的路径</a><ul><li><a href=#宝塔nginx的ssl证书路径>宝塔Nginx的SSL证书路径</a></li></ul></li><li><a href=#配置web服务器websocket的规则>配置WEB服务器WebSocket的规则</a></li><li><a href=#reality>REALITY</a></li></ul></nav></div></details></div><div class=post-content><p>近期更新重点</p><ul><li>V2Ray v4.27.0+新增支持VLESS新协议</li><li>V2Ray v4.29.0+新增支持XTLS新协议</li><li>Vadminss AEAD will be used when alterId is 0 in V2Ray v4.28.0+</li><li>安装脚本放废弃<code>go.sh</code>改用<code>install-realese.sh</code></li><li>V2Ray v4.33.0移除了XTLS，建议使用V2Ray v4.32.1</li></ul><p>详情参考</p><ol><li><a href=https://v2ray.com/>https://v2ray.com/</a></li><li><a href=https://github.com/v2ray/v2ray-core>https://github.com/v2ray/v2ray-core</a></li><li><a href=https://toutyrater.github.io/>https://toutyrater.github.io/</a></li><li><a href=https://guide.v2fly.org/>https://guide.v2fly.org/</a></li><li><a href=https://github.com/veekxt/v2ray-template>https://github.com/veekxt/v2ray-template</a></li><li><a href=https://github.com/v2fly/v2ray-examples>https://github.com/v2fly/v2ray-examples</a></li><li><a href=https://www.v2fly.org/>https://www.v2fly.org/</a></li><li><a href=https://github.com/rprx/v2ray-vless>https://github.com/rprx/v2ray-vless</a></li><li><a href=https://github.com/v2fly/v2ray-core>https://github.com/v2fly/v2ray-core</a></li><li><a href=https://github.com/XTLS/Xray-core>https://github.com/XTLS/Xray-core</a></li></ol><p>排名不分先后顺序 致敬开发者们的无私奉献</p><hr><h2 id=xray>xray<a hidden class=anchor aria-hidden=true href=#xray>#</a></h2><blockquote><p><a href=https://github.com/XTLS/Xray-core>https://github.com/XTLS/Xray-core</a></p></blockquote><h3 id=install--upgrade-xray-core-and-dat-files>Install & Upgrade Xray-core and .dat files<a hidden class=anchor aria-hidden=true href=#install--upgrade-xray-core-and-dat-files>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash &lt;<span class=o>(</span>curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh<span class=o>)</span>
</span></span></code></pre></div><h3 id=update-geoipdat-and-geositedat-only>Update geoip.dat and geosite.dat only<a hidden class=anchor aria-hidden=true href=#update-geoipdat-and-geositedat-only>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash &lt;<span class=o>(</span>curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-dat-release.sh<span class=o>)</span>
</span></span></code></pre></div><h3 id=remove-xray-except-json-and-logs>Remove Xray, except json and logs<a hidden class=anchor aria-hidden=true href=#remove-xray-except-json-and-logs>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash &lt;<span class=o>(</span>curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh<span class=o>)</span> --remove
</span></span></code></pre></div><p>成功安装后会提示如下</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># /etc/systemd/system/xray.service</span>
</span></span><span class=line><span class=cl><span class=o>[</span>Unit<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>Description</span><span class=o>=</span>Xray Service
</span></span><span class=line><span class=cl><span class=nv>Documentation</span><span class=o>=</span>https://github.com/xtls
</span></span><span class=line><span class=cl><span class=nv>After</span><span class=o>=</span>network.target nss-lookup.target
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Service<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>User</span><span class=o>=</span>nobody
</span></span><span class=line><span class=cl><span class=nv>CapabilityBoundingSet</span><span class=o>=</span>CAP_NET_ADMIN CAP_NET_BIND_SERVICE
</span></span><span class=line><span class=cl><span class=nv>AmbientCapabilities</span><span class=o>=</span>CAP_NET_ADMIN CAP_NET_BIND_SERVICE
</span></span><span class=line><span class=cl><span class=nv>NoNewPrivileges</span><span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>/usr/local/bin/xray run -config /usr/local/etc/xray/config.json
</span></span><span class=line><span class=cl><span class=nv>Restart</span><span class=o>=</span>on-failure
</span></span><span class=line><span class=cl><span class=nv>RestartPreventExitStatus</span><span class=o>=</span><span class=m>23</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Install<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>WantedBy</span><span class=o>=</span>multi-user.target
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># /etc/systemd/system/xray.service.d/10-donot_touch_single_conf.conf</span>
</span></span><span class=line><span class=cl><span class=c1># In case you have a good reason to do so, duplicate this file in the same directory and make your customizes there.</span>
</span></span><span class=line><span class=cl><span class=c1># Or all changes you made will be lost!  # Refer: https://www.freedesktop.org/software/systemd/man/systemd.unit.html</span>
</span></span><span class=line><span class=cl><span class=o>[</span>Service<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>/usr/local/bin/xray run -config /usr/local/etc/xray/config.json
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>installed: /usr/local/bin/xray
</span></span><span class=line><span class=cl>installed: /usr/local/share/xray/geoip.dat
</span></span><span class=line><span class=cl>installed: /usr/local/share/xray/geosite.dat
</span></span><span class=line><span class=cl>installed: /usr/local/etc/xray/config.json
</span></span><span class=line><span class=cl>installed: /var/log/xray/
</span></span><span class=line><span class=cl>installed: /var/log/xray/access.log
</span></span><span class=line><span class=cl>installed: /var/log/xray/error.log
</span></span><span class=line><span class=cl>installed: /etc/systemd/system/xray.service
</span></span><span class=line><span class=cl>installed: /etc/systemd/system/xray@.service
</span></span><span class=line><span class=cl>removed: /tmp/tmp.S3mHoPXvIj
</span></span><span class=line><span class=cl>info: Xray v1.1.2 is installed.
</span></span><span class=line><span class=cl>You may need to execute a <span class=nb>command</span> to remove dependent software: apt purge curl unzip
</span></span><span class=line><span class=cl>Please execute the command: systemctl <span class=nb>enable</span> xray<span class=p>;</span> systemctl start xray
</span></span></code></pre></div><p>解决SSL证书权限不足</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sed -i <span class=s1>&#39;s/User=nobody/User=root/&#39;</span> /etc/systemd/system/xray.service
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/User=nobody/User=root/&#39;</span> /etc/systemd/system/xray@.service
</span></span></code></pre></div><p>编辑创建xray配置文件</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano /usr/local/etc/xray/config.json
</span></span></code></pre></div><p>输入以下示范</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;log&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;loglevel&#34;</span>: <span class=s2>&#34;warning&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;inbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 443,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vless&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;clients&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>, // 填写你的 UUID
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;flow&#34;</span>: <span class=s2>&#34;xtls-rprx-direct&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;level&#34;</span>: 0,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;email&#34;</span>: <span class=s2>&#34;love@v2fly.org&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;decryption&#34;</span>: <span class=s2>&#34;none&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;fallbacks&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;dest&#34;</span>: <span class=m>81</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>,
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;path&#34;</span>: <span class=s2>&#34;/websocket&#34;</span>, // 必须换成自定义的 PATH
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;dest&#34;</span>: 1234,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;xver&#34;</span>: <span class=m>1</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;tcp&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;xtls&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;xtlsSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;alpn&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;http/1.1&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>]</span>,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;certificates&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                        <span class=o>{</span>
</span></span><span class=line><span class=cl>                            <span class=s2>&#34;certificateFile&#34;</span>: <span class=s2>&#34;/etc/letsencrypt/live/example.com/fullchain.pem&#34;</span>, // 换成你的证书，绝对路径
</span></span><span class=line><span class=cl>                            <span class=s2>&#34;keyFile&#34;</span>: <span class=s2>&#34;/etc/letsencrypt/live/example.com/privkey.pem&#34;</span> // 换成你的私钥，绝对路径
</span></span><span class=line><span class=cl>                        <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=o>]</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 1234,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;listen&#34;</span>: <span class=s2>&#34;127.0.0.1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vless&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;clients&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>, // 填写你的 UUID
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;level&#34;</span>: 0,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;email&#34;</span>: <span class=s2>&#34;love@v2fly.org&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;decryption&#34;</span>: <span class=s2>&#34;none&#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;ws&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;none&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;wsSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;acceptProxyProtocol&#34;</span>: true, // 提醒：若你用 Nginx/Caddy 等反代 WS，需要删掉这行
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;path&#34;</span>: <span class=s2>&#34;/websocket&#34;</span> // 必须换成自定义的 PATH，需要和分流的一致
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;shadowsocks&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 1038,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;method&#34;</span>: <span class=s2>&#34;chacha20-ietf-poly1305&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;password&#34;</span>: <span class=s2>&#34;yourpassword###&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;udp&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;shadowsocks&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 1039,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;method&#34;</span>: <span class=s2>&#34;aes-128-gcm&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;password&#34;</span>: <span class=s2>&#34;youpassword###&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;udp&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>		<span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;port&#34;</span>: 5678,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vmess&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;clients&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>				<span class=o>{</span>
</span></span><span class=line><span class=cl>					<span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>					<span class=s2>&#34;alterId&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>				<span class=o>}</span>
</span></span><span class=line><span class=cl>			<span class=o>]</span>
</span></span><span class=line><span class=cl>			<span class=o>}</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;kcp&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;aes-128-gcm&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;kcpSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>					<span class=s2>&#34;mtu&#34;</span>: 1350,
</span></span><span class=line><span class=cl>					<span class=s2>&#34;tti&#34;</span>: 20,
</span></span><span class=line><span class=cl>					<span class=s2>&#34;uplinkCapacity&#34;</span>: 5,
</span></span><span class=line><span class=cl>					<span class=s2>&#34;downlinkCapacity&#34;</span>: 100,
</span></span><span class=line><span class=cl>					<span class=s2>&#34;congestion&#34;</span>: false,
</span></span><span class=line><span class=cl>					<span class=s2>&#34;readBufferSize&#34;</span>: 1,
</span></span><span class=line><span class=cl>					<span class=s2>&#34;writeBufferSize&#34;</span>: 1,
</span></span><span class=line><span class=cl>					<span class=s2>&#34;header&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>						<span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;none&#34;</span>
</span></span><span class=line><span class=cl>					<span class=o>}</span>,
</span></span><span class=line><span class=cl>					<span class=s2>&#34;seed&#34;</span>: <span class=s2>&#34;Password###&#34;</span>
</span></span><span class=line><span class=cl>				<span class=o>}</span>
</span></span><span class=line><span class=cl>			<span class=o>}</span>
</span></span><span class=line><span class=cl>		<span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;outbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;freedom&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget -O /usr/local/etc/xray/config.json https://567899.xyz/uploads/xray-server-config.json
</span></span></code></pre></div><p>替换自己的UUID和域名</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sed -i <span class=s1>&#39;s/&#34;&#34;/&#34;UUID&#34;/&#39;</span> /usr/local/etc/xray/config.json
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/example.com/你的域名/&#39;</span> /usr/local/etc/xray/config.json
</span></span></code></pre></div><p>启动xray</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl <span class=nb>enable</span> xray
</span></span><span class=line><span class=cl>systemctl start xray
</span></span></code></pre></div><h2 id=解决ip谷歌搜索人机验证码>解决IP谷歌搜索人机验证码<a hidden class=anchor aria-hidden=true href=#解决ip谷歌搜索人机验证码>#</a></h2><ol><li>warp双栈，v4v6出口全部由warp接管</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash &lt;<span class=o>(</span>curl -fsSL https://raw.githubusercontent.com/P3TERX/warp.sh/main/warp.sh<span class=o>)</span> d
</span></span></code></pre></div><ol start=2><li>添加v4出口，v4出口warp接管</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash &lt;<span class=o>(</span>curl -fsSL https://raw.githubusercontent.com/P3TERX/warp.sh/main/warp.sh<span class=o>)</span> <span class=m>4</span>
</span></span></code></pre></div><ol start=3><li>添加v6出口，v6出口warp接管，需要在扶墙配置文件里指定google走v6</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash &lt;<span class=o>(</span>curl -fsSL https://raw.githubusercontent.com/P3TERX/warp.sh/main/warp.sh<span class=o>)</span> <span class=m>6</span>
</span></span></code></pre></div><p>然后编辑<code>/usr/local/etc/xray/config.json</code>修改替换<code>outbounds</code>和<code>routing</code>为以下内容</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>	<span class=s2>&#34;outbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>             <span class=o>{</span>
</span></span><span class=line><span class=cl>               <span class=s2>&#34;tag&#34;</span>:<span class=s2>&#34;IP4_out&#34;</span>,
</span></span><span class=line><span class=cl>               <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;freedom&#34;</span>,
</span></span><span class=line><span class=cl>               <span class=s2>&#34;settings&#34;</span>: <span class=o>{}</span>
</span></span><span class=line><span class=cl>             <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=o>{</span>
</span></span><span class=line><span class=cl>               <span class=s2>&#34;tag&#34;</span>:<span class=s2>&#34;IP6_out&#34;</span>,
</span></span><span class=line><span class=cl>               <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;freedom&#34;</span>,
</span></span><span class=line><span class=cl>              <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                   <span class=s2>&#34;domainStrategy&#34;</span>: <span class=s2>&#34;UseIPv6&#34;</span> // 指定使用 IPv6
</span></span><span class=line><span class=cl>                   <span class=o>}</span>
</span></span><span class=line><span class=cl>             <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>]</span>,
</span></span><span class=line><span class=cl>	<span class=s2>&#34;routing&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;rules&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                <span class=o>{</span>
</span></span><span class=line><span class=cl>                 <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;field&#34;</span>,
</span></span><span class=line><span class=cl>                 <span class=s2>&#34;outboundTag&#34;</span>: <span class=s2>&#34;IP6_out&#34;</span>,
</span></span><span class=line><span class=cl>                 <span class=s2>&#34;domain&#34;</span>: <span class=o>[</span><span class=s2>&#34;domain:www.google.com&#34;</span><span class=o>]</span> // google走 IPv6
</span></span><span class=line><span class=cl>                 <span class=o>}</span>,
</span></span><span class=line><span class=cl>                <span class=o>{</span>
</span></span><span class=line><span class=cl>                   <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;field&#34;</span>,
</span></span><span class=line><span class=cl>                   <span class=s2>&#34;outboundTag&#34;</span>: <span class=s2>&#34;IP4_out&#34;</span>,
</span></span><span class=line><span class=cl>                   <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;udp,tcp&#34;</span>// 其余走 IPv4
</span></span><span class=line><span class=cl>                 <span class=o>}</span>
</span></span><span class=line><span class=cl>             <span class=o>]</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span></code></pre></div><p><a href=/uploads/xray_warp_ipv6_google_config.json>点击下载完整的配置文件示范</a></p><p>重启VPS查看效果</p><p>nginx配置示范</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>    listen <span class=o>[</span>::<span class=o>]</span>:80<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>    root /var/www/example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>    index index.html index.htm index.php<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>#return 301 https://$server_name$request_uri;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen 81<span class=p>;</span>
</span></span><span class=line><span class=cl>    listen <span class=o>[</span>::<span class=o>]</span>:81<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>    root /var/www/example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>    index index.html index.htm index.php<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>#php</span>
</span></span><span class=line><span class=cl>    location ~ <span class=se>\.</span>php$ <span class=o>{</span>
</span></span><span class=line><span class=cl>    include snippets/fastcgi-php.conf<span class=p>;</span>
</span></span><span class=line><span class=cl>    fastcgi_pass unix:/run/php/php7.3-fpm.sock<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><hr><h2 id=安装v2ray>安装V2ray<a hidden class=anchor aria-hidden=true href=#安装v2ray>#</a></h2><p>安裝和更新 V2Ray</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#安裝執行檔和 .dat 資料檔</span>
</span></span><span class=line><span class=cl>curl -LROJ https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-release.sh
</span></span><span class=line><span class=cl>bash install-release.sh
</span></span></code></pre></div><p>安裝最新發行的 geoip.dat 和 geosite.dat</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#只更新 .dat 資料檔</span>
</span></span><span class=line><span class=cl>curl -LROJ https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-dat-release.sh
</span></span><span class=line><span class=cl>bash install-dat-release.sh
</span></span></code></pre></div><p>移除 V2Ray</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash install-release.sh --remove
</span></span></code></pre></div><p>指定版本安装示范</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash install-release.sh --version v4.32.1
</span></span></code></pre></div><p>完成安装会提示如下</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>Service<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>/usr/local/bin/v2ray -config /usr/local/etc/v2ray/%i.json
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>installed: /usr/local/bin/v2ray
</span></span><span class=line><span class=cl>installed: /usr/local/bin/v2ctl
</span></span><span class=line><span class=cl>installed: /usr/local/share/v2ray/geoip.dat
</span></span><span class=line><span class=cl>installed: /usr/local/share/v2ray/geosite.dat
</span></span><span class=line><span class=cl>installed: /usr/local/etc/v2ray/config.json
</span></span><span class=line><span class=cl>installed: /var/log/v2ray/
</span></span><span class=line><span class=cl>installed: /var/log/v2ray/access.log
</span></span><span class=line><span class=cl>installed: /var/log/v2ray/error.log
</span></span><span class=line><span class=cl>installed: /etc/systemd/system/v2ray.service
</span></span><span class=line><span class=cl>installed: /etc/systemd/system/v2ray@.service
</span></span><span class=line><span class=cl>removed: /tmp/tmp.MMsycHU0KG
</span></span><span class=line><span class=cl>info: V2Ray v4.29.0 is installed.
</span></span><span class=line><span class=cl>You may need to execute a <span class=nb>command</span> to remove dependent software: apt purge curl unzip
</span></span><span class=line><span class=cl>Please execute the command: systemctl <span class=nb>enable</span> v2ray<span class=p>;</span> systemctl start v2ray
</span></span></code></pre></div><h2 id=v2ray在使用vless时证书权限的解决办法>V2ray在使用VLESS时证书权限的解决办法<a hidden class=anchor aria-hidden=true href=#v2ray在使用vless时证书权限的解决办法>#</a></h2><p>使用證書時權限不足 会导致套用模板后V2ray无法启动且无错误日志</p><p>简单粗暴的解决方法是编辑修改<code>/etc/systemd/system/v2ray.service</code>找到<code>User=nobody</code>修改为<code>User=root</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sed -i <span class=s1>&#39;s/User=nobody/User=root/&#39;</span> /etc/systemd/system/v2ray.service
</span></span></code></pre></div><p>详情参考<a href=https://github.com/v2fly/fhs-install-v2ray/wiki/Insufficient-permissions-when-using-certificates>使用證書時權限不足</a></p><h2 id=编辑配置文件>编辑配置文件<a hidden class=anchor aria-hidden=true href=#编辑配置文件>#</a></h2><p><code>uuid</code>可以通过</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /proc/sys/kernel/random/uuid
</span></span></code></pre></div><p>或者</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>v2ctl uuid
</span></span></code></pre></div><p>随机生成</p><p>测试配置文件是否错误</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>v2ray -test -config<span class=o>=</span>config.json
</span></span></code></pre></div><h2 id=推荐组合模式>推荐组合模式<a hidden class=anchor aria-hidden=true href=#推荐组合模式>#</a></h2><ol><li>VLESS TCP XTLS</li></ol><p>极致性能，超低的CPU占用，在硬路由器，手机上表现突出</p><ol start=2><li>VLESS over WS with TLS CDN</li></ol><p>服务器公网IP被xxoo了就能套娃使用</p><ol start=3><li>Vmess KCP udp2raw</li></ol><p>在高丢包、高延迟、网络线路不佳的情况表现突出</p><h3 id=v2ray服务端配置文件>V2Ray服务端配置文件<a hidden class=anchor aria-hidden=true href=#v2ray服务端配置文件>#</a></h3><p>客户端可以同时通过下列方式连接到服务器，其中 WS 都可以通过 CDN</p><ul><li>VLESS over TCP with XTLS</li><li>VLESS over TCP with TLS</li><li>VLESS over WS with TLS</li><li>VLESS over WS with TLS CDN</li><li>shadowsocks</li></ul><p>编辑修改<code>/usr/local/etc/v2ray/config.json</code>替换成以下内容</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;log&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;loglevel&#34;</span>: <span class=s2>&#34;warning&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;inbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 443,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vless&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;clients&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>, // 填写你的 UUID
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;flow&#34;</span>: <span class=s2>&#34;xtls-rprx-origin&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;level&#34;</span>: 0,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;email&#34;</span>: <span class=s2>&#34;love@v2fly.org&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;decryption&#34;</span>: <span class=s2>&#34;none&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;fallbacks&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;dest&#34;</span>: <span class=s2>&#34;/dev/shm/default.sock&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;xver&#34;</span>: <span class=m>1</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>,
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;alpn&#34;</span>: <span class=s2>&#34;h2&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;dest&#34;</span>: <span class=s2>&#34;/dev/shm/h2c.sock&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;xver&#34;</span>: <span class=m>1</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>,
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;path&#34;</span>: <span class=s2>&#34;/websocket&#34;</span>, // 必须换成自定义的 PATH
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;dest&#34;</span>: 1234,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;xver&#34;</span>: <span class=m>1</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;tcp&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;xtls&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;xtlsSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;alpn&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;h2&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;http/1.1&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>]</span>,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;certificates&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                        <span class=o>{</span>
</span></span><span class=line><span class=cl>                            <span class=s2>&#34;certificateFile&#34;</span>: <span class=s2>&#34;/path/to/fullchain.crt&#34;</span>, // 换成你的证书，绝对路径
</span></span><span class=line><span class=cl>                            <span class=s2>&#34;keyFile&#34;</span>: <span class=s2>&#34;/path/to/private.key&#34;</span> // 换成你的私钥，绝对路径
</span></span><span class=line><span class=cl>                        <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=o>]</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 1234,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;listen&#34;</span>: <span class=s2>&#34;127.0.0.1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vless&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;clients&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>, // 填写你的 UUID
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;level&#34;</span>: 0,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;email&#34;</span>: <span class=s2>&#34;love@v2fly.org&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;decryption&#34;</span>: <span class=s2>&#34;none&#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;ws&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;none&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;wsSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;acceptProxyProtocol&#34;</span>: true, // 提醒：若你用 Nginx/Caddy 等反代 WS，需要删掉这行
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;path&#34;</span>: <span class=s2>&#34;/websocket&#34;</span> // 必须换成自定义的 PATH，需要和分流的一致
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;shadowsocks&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 1038,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;method&#34;</span>: <span class=s2>&#34;chacha20-ietf-poly1305&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;password&#34;</span>: <span class=s2>&#34;yourpassword&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;udp&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;shadowsocks&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 1039,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;method&#34;</span>: <span class=s2>&#34;aes-128-gcm&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;password&#34;</span>: <span class=s2>&#34;youpassword&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;udp&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>		<span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;port&#34;</span>: 7777,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vmess&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;clients&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>				<span class=o>{</span>
</span></span><span class=line><span class=cl>					<span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>, // 填写你的 UUID
</span></span><span class=line><span class=cl>					<span class=s2>&#34;alterId&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>				<span class=o>}</span>
</span></span><span class=line><span class=cl>			<span class=o>]</span>
</span></span><span class=line><span class=cl>			<span class=o>}</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;kcp&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;aes-128-gcm&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;kcpSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>				<span class=s2>&#34;mtu&#34;</span>: 1350,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;tti&#34;</span>: 20,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;uplinkCapacity&#34;</span>: 5,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;downlinkCapacity&#34;</span>: 100,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;congestion&#34;</span>: false,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;readBufferSize&#34;</span>: 1,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;writeBufferSize&#34;</span>: 1,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;header&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>					<span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;none&#34;</span>
</span></span><span class=line><span class=cl>				<span class=o>}</span>,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;seed&#34;</span>: <span class=s2>&#34;Password&#34;</span>
</span></span><span class=line><span class=cl>				<span class=o>}</span>
</span></span><span class=line><span class=cl>			<span class=o>}</span>
</span></span><span class=line><span class=cl>		<span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;outbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;freedom&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>V2ray v4.31.0+可以更改<code>xtls-rprx-origin</code>为<code>xtls-rprx-direct</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sed -i <span class=s1>&#39;s/xtls-rprx-origin/xtls-rprx-direct/&#39;</span> /usr/local/etc/v2ray/config.json
</span></span></code></pre></div><p>替换自己的<code>UUID</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sed -i <span class=s1>&#39;s/&#34;id&#34;: &#34;&#34;/&#34;id&#34;: &#34;这里替换成你的UUID值&#34;/&#39;</span> /usr/local/etc/v2ray/config.json
</span></span></code></pre></div><h2 id=配置nginx>配置Nginx<a hidden class=anchor aria-hidden=true href=#配置nginx>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen  unix:/dev/shm/default.sock proxy_protocol<span class=p>;</span>
</span></span><span class=line><span class=cl>    listen  unix:/dev/shm/h2c.sock http2 proxy_protocol<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>    root /var/www/example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>    index index.html index.htm index.php<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>#php</span>
</span></span><span class=line><span class=cl>    location ~ <span class=se>\.</span>php$ <span class=o>{</span>
</span></span><span class=line><span class=cl>    include snippets/fastcgi-php.conf<span class=p>;</span>
</span></span><span class=line><span class=cl>    fastcgi_pass unix:/run/php/php7.3-fpm.sock<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>    listen <span class=o>[</span>::<span class=o>]</span>:80<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>    root /var/www/example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>    index index.html index.htm index.php<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=m>301</span> https://<span class=nv>$server_name$request_uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=客户端连接>客户端连接<a hidden class=anchor aria-hidden=true href=#客户端连接>#</a></h2><h3 id=vless--tcp--xtls>VLESS & TCP & XTLS<a hidden class=anchor aria-hidden=true href=#vless--tcp--xtls>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;log&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;loglevel&#34;</span>: <span class=s2>&#34;warning&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;inbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 10800,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;listen&#34;</span>: <span class=s2>&#34;127.0.0.1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;socks&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;udp&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;outbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vless&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;vnext&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;address&#34;</span>: <span class=s2>&#34;example.com&#34;</span>, // 换成你的域名或服务器 IP（发起请求时无需解析域名了）
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;port&#34;</span>: 443,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;users&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                            <span class=o>{</span>
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>, // 填写你的 UUID
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;flow&#34;</span>: <span class=s2>&#34;xtls-rprx-origin&#34;</span>,
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;encryption&#34;</span>: <span class=s2>&#34;none&#34;</span>,
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;level&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>                            <span class=o>}</span>
</span></span><span class=line><span class=cl>                        <span class=o>]</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;tcp&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;xtls&#34;</span>, // 需要使用 XTLS
</span></span><span class=line><span class=cl>                <span class=s2>&#34;xtlsSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;serverName&#34;</span>: <span class=s2>&#34;example.com&#34;</span> // 换成你的域名
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=vless_ws_tlsjson>vless_ws_tls.json<a hidden class=anchor aria-hidden=true href=#vless_ws_tlsjson>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;log&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;loglevel&#34;</span>: <span class=s2>&#34;warning&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;inbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 10800,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;listen&#34;</span>: <span class=s2>&#34;127.0.0.1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;socks&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;udp&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;outbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vless&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;vnext&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;address&#34;</span>: <span class=s2>&#34;example.com&#34;</span>, // 换成你的域名或服务器 IP（发起请求时无需解析域名了）
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;port&#34;</span>: 443,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;users&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                            <span class=o>{</span>
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>, // 填写你的 UUID
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;encryption&#34;</span>: <span class=s2>&#34;none&#34;</span>,
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;level&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>                            <span class=o>}</span>
</span></span><span class=line><span class=cl>                        <span class=o>]</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;ws&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;tls&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;tlsSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;serverName&#34;</span>: <span class=s2>&#34;example.com&#34;</span> // 换成你的域名
</span></span><span class=line><span class=cl>                <span class=o>}</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;wsSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;path&#34;</span>: <span class=s2>&#34;/websocket&#34;</span> // 必须换成自定义的 PATH，需要和服务端的一致
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=vmess_ws_tlsjson>vmess_ws_tls.json<a hidden class=anchor aria-hidden=true href=#vmess_ws_tlsjson>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;log&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;loglevel&#34;</span>: <span class=s2>&#34;warning&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;inbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 10800,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;listen&#34;</span>: <span class=s2>&#34;127.0.0.1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;socks&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;udp&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;outbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vmess&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;vnext&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;address&#34;</span>: <span class=s2>&#34;example.com&#34;</span>, // 换成你的域名或服务器 IP（发起请求时无需解析域名了）
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;port&#34;</span>: 443,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;users&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                            <span class=o>{</span>
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>, // 填写你的 UUID
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;none&#34;</span>,
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;level&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>                            <span class=o>}</span>
</span></span><span class=line><span class=cl>                        <span class=o>]</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;ws&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;tls&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;tlsSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;serverName&#34;</span>: <span class=s2>&#34;example.com&#34;</span> // 换成你的域名
</span></span><span class=line><span class=cl>                <span class=o>}</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;wsSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;path&#34;</span>: <span class=s2>&#34;/vmessws&#34;</span> // 必须换成自定义的 PATH，需要和服务端的一致
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=vless-h2c-caddy2>VLESS-H2C-Caddy2<a hidden class=anchor aria-hidden=true href=#vless-h2c-caddy2>#</a></h2><p>注意： 目前仅 caddy2 的 v2.2.0-rc.1 版及以后完美支持 v2ray 的 H2C,实现 H2(HTTP/2)应用。</p><p>V2ray配置文件</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;log&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;loglevel&#34;</span>: <span class=s2>&#34;none&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;inbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;sniffing&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;enabled&#34;</span>: true,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;destOverride&#34;</span>: <span class=o>[</span><span class=s2>&#34;http&#34;</span>,<span class=s2>&#34;tls&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;listen&#34;</span>: <span class=s2>&#34;127.0.0.1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 10443,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;tag&#34;</span>: <span class=s2>&#34;vless-in&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vless&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;clients&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>, // uuid
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;level&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;decryption&#34;</span>: <span class=s2>&#34;none&#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;h2&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;none&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;httpSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;path&#34;</span>: <span class=s2>&#34;/path&#34;</span>,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;host&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>]</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;outbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;freedom&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span> <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;tag&#34;</span>: <span class=s2>&#34;direct&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;blackhole&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span> <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;tag&#34;</span>: <span class=s2>&#34;block&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;dns&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;servers&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;https://cloudflare-dns.com/dns-query&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;https://dns.google/dns-query&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;routing&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;domainStrategy&#34;</span>: <span class=s2>&#34;AsIs&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;rules&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>            <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;field&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inboundTag&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                  <span class=s2>&#34;vless-in&#34;</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;outboundTag&#34;</span>: <span class=s2>&#34;direct&#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;field&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;outboundTag&#34;</span>: <span class=s2>&#34;block&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;protocol&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;bittorrent&#34;</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Caddy2的Caddyfile</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>example.com <span class=o>{</span>
</span></span><span class=line><span class=cl>encode zstd gzip
</span></span><span class=line><span class=cl>root * /usr/share/caddy/example.com
</span></span><span class=line><span class=cl>file_server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>tls admin@example.com <span class=o>{</span>
</span></span><span class=line><span class=cl>    protocols tls1.3
</span></span><span class=line><span class=cl>    curves x25519
</span></span><span class=line><span class=cl>    alpn h2
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>header <span class=o>{</span>
</span></span><span class=line><span class=cl>        Strict-Transport-Security max-age<span class=o>=</span>31536000<span class=p>;</span>
</span></span><span class=line><span class=cl>        X-Content-Type-Options nosniff
</span></span><span class=line><span class=cl>        X-Frame-Options DENY
</span></span><span class=line><span class=cl>        Referrer-Policy no-referrer-when-downgrade
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>reverse_proxy /v2ray?id<span class=o>=</span>v2ray 127.0.0.1:10443 <span class=o>{</span>
</span></span><span class=line><span class=cl>     header_up Host <span class=o>{</span>http.request.host<span class=o>}</span>
</span></span><span class=line><span class=cl>     header_up X-Real-IP <span class=o>{</span>http.request.remote<span class=o>}</span>
</span></span><span class=line><span class=cl>     header_up X-Forwarded-For <span class=o>{</span>http.request.remote<span class=o>}</span>
</span></span><span class=line><span class=cl>     header_up X-Forwarded-Port <span class=o>{</span>http.request.port<span class=o>}</span>
</span></span><span class=line><span class=cl>     header_up X-Forwarded-Proto <span class=o>{</span>http.request.scheme<span class=o>}</span>
</span></span><span class=line><span class=cl>     header_up Connection <span class=o>{</span>http.request.header.Connection<span class=o>}</span>
</span></span><span class=line><span class=cl>     header_up Upgrade <span class=o>{</span>http.request.header.Upgrade<span class=o>}</span>
</span></span><span class=line><span class=cl>     transport http <span class=o>{</span>
</span></span><span class=line><span class=cl>         versions h2c
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>客户端</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;log&#34;</span>:<span class=o>{}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;inbounds&#34;</span>:<span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;port&#34;</span>:<span class=s2>&#34;1080&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;protocol&#34;</span>:<span class=s2>&#34;socks&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;settings&#34;</span>:<span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;auth&#34;</span>:<span class=s2>&#34;noauth&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;udp&#34;</span>:true
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;port&#34;</span>:<span class=s2>&#34;1081&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;protocol&#34;</span>:<span class=s2>&#34;http&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;settings&#34;</span>:<span class=o>{}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>]</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;outbounds&#34;</span>:<span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;protocol&#34;</span>:<span class=s2>&#34;vless&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;settings&#34;</span>:<span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;vnext&#34;</span>:<span class=o>[</span>
</span></span><span class=line><span class=cl>          <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;address&#34;</span>:<span class=s2>&#34;example.com&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>:443,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;users&#34;</span>:<span class=o>[</span>
</span></span><span class=line><span class=cl>              <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;id&#34;</span>:<span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;encryption&#34;</span>:<span class=s2>&#34;none&#34;</span>
</span></span><span class=line><span class=cl>              <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>]</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;streamSettings&#34;</span>:<span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;network&#34;</span>:<span class=s2>&#34;h2&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;security&#34;</span>:<span class=s2>&#34;tls&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;httpSettings&#34;</span>:<span class=o>{</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;host&#34;</span>:<span class=o>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;example.com&#34;</span>
</span></span><span class=line><span class=cl>          <span class=o>]</span>,
</span></span><span class=line><span class=cl>          <span class=s2>&#34;path&#34;</span>:<span class=s2>&#34;/path&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;tag&#34;</span>:<span class=s2>&#34;direct&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;protocol&#34;</span>:<span class=s2>&#34;freedom&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;settings&#34;</span>:<span class=o>{}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;tag&#34;</span>:<span class=s2>&#34;blocked&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;protocol&#34;</span>:<span class=s2>&#34;blackhole&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;settings&#34;</span>:<span class=o>{}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>]</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;routing&#34;</span>:<span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;domainStrategy&#34;</span>:<span class=s2>&#34;IPOnDemand&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;rules&#34;</span>:<span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;type&#34;</span>:<span class=s2>&#34;field&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;ip&#34;</span>:<span class=o>[</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;geoip:private&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;outboundTag&#34;</span>:<span class=s2>&#34;direct&#34;</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=udp2raw-vmess-kcp>udp2raw vmess kcp<a hidden class=anchor aria-hidden=true href=#udp2raw-vmess-kcp>#</a></h2><blockquote><p><a href=https://github.com/wangyu-/udp2raw-tunnel>udp2raw-tunnel</a></p></blockquote><p><a href=https://github.com/wangyu-/udp2raw-tunnel/releases>下载udp2raw-tunnel</a></p><h3 id=udp2raw服务端设置debainubuntucentos>udp2raw服务端设置(Debain,Ubuntu,Centos)<a hidden class=anchor aria-hidden=true href=#udp2raw服务端设置debainubuntucentos>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://github.com/wangyu-/udp2raw-tunnel/releases/download/20200818.0/udp2raw_binaries.tar.gz
</span></span><span class=line><span class=cl>tar -zxvf udp2raw_binaries.tar.gz
</span></span><span class=line><span class=cl>mv udp2raw_amd64 /usr/bin/udp2raw
</span></span></code></pre></div><h3 id=运行>运行<a hidden class=anchor aria-hidden=true href=#运行>#</a></h3><p>假设你有一个server，ip为<code>44.55.66.77</code>，有一个服务监听在<code>udp 7777</code>端口。 假设你本地的主机到<code>44.55.66.77</code>的UDP流量被屏蔽了，或者被qos了</p><p>在server端运行:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>udp2raw -s -l0.0.0.0:4096  -r127.0.0.1:7777   -k <span class=s2>&#34;passwd&#34;</span> --raw-mode faketcp   --cipher-mode xor  -a
</span></span></code></pre></div><p>(以上例子需要用root账号运行。 用非root运行udp2raw需要一些额外的步骤，具体方法请看 这个 链接。用非root运行更安全)</p><h3 id=udp2raw创建开机自动启动服务>udp2raw创建开机自动启动服务<a hidden class=anchor aria-hidden=true href=#udp2raw创建开机自动启动服务>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[Unit]
</span></span></span><span class=line><span class=cl><span class=s2>Description=udp2raw server
</span></span></span><span class=line><span class=cl><span class=s2>After=network.service
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>[Service]
</span></span></span><span class=line><span class=cl><span class=s2>Type=simple
</span></span></span><span class=line><span class=cl><span class=s2>User=root
</span></span></span><span class=line><span class=cl><span class=s2>Group=root
</span></span></span><span class=line><span class=cl><span class=s2>ExecStart=/usr/bin/udp2raw  -s -l0.0.0.0:4096  -r127.0.0.1:7777   -k &#34;</span>passwd<span class=s2>&#34; --raw-mode faketcp   --cipher-mode xor  -a &amp;
</span></span></span><span class=line><span class=cl><span class=s2>PrivateTmp=true
</span></span></span><span class=line><span class=cl><span class=s2>Restart=on-failure
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>[Install]
</span></span></span><span class=line><span class=cl><span class=s2>WantedBy=multi-user.target&#34;</span> &gt; /etc/systemd/system/udp2raw.service
</span></span></code></pre></div><h3 id=udp2raw管理进程>udp2raw管理进程<a hidden class=anchor aria-hidden=true href=#udp2raw管理进程>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl daemon-reload
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> udp2raw.service
</span></span><span class=line><span class=cl>systemctl start udp2raw.service
</span></span><span class=line><span class=cl>systemctl status udp2raw.service
</span></span></code></pre></div><h3 id=udp2raw在client端运行>udp2raw在client端运行:<a hidden class=anchor aria-hidden=true href=#udp2raw在client端运行>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./udp2raw_amd64 -c -l0.0.0.0:3333  -r44.55.66.77:4096 -k <span class=s2>&#34;passwd&#34;</span> --raw-mode faketcp   --cipher-mode xor  -a
</span></span></code></pre></div><p><strong>android设备上运行udp2raw(arm cpu)</strong></p><p>照常运行<code>udp2raw_arm</code>，除了必须将<code>-a</code>选项更改为<code>-g</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./udp2raw_arm -c -r 44.55.66.77:4096 -l 0.0.0.0:3333 -k1234 --cipher xor -g
</span></span></code></pre></div><p>从udp2raw的输出中找到生成的iptables规则，通过运行手动将其添加：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>iptables -I INPUT -s 44.55.66.77/32 -p tcp -m tcp --sport <span class=m>4096</span> -j DROP
</span></span></code></pre></div><p>在不使用-g命令的情况下运行udp2raw_ram</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./udp2raw_arm -c -r 44.55.66.77:4096 -l 0.0.0.0:3333 -k1234 --cipher xor
</span></span></code></pre></div><p><strong>注意将<code>44.55.66.77</code>替换成你自己服务器的公网IP地址</strong></p><h3 id=vmess-kcp客户端v2ray配置>Vmess KCP客户端V2ray配置<a hidden class=anchor aria-hidden=true href=#vmess-kcp客户端v2ray配置>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;inbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 10808,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;listen&#34;</span>: <span class=s2>&#34;127.0.0.1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;socks&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;udp&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;outbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vmess&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;vnext&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>          <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;address&#34;</span>: <span class=s2>&#34;127.0.0.1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 3333,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;users&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>              <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;&#34;</span>,  // 填写你的 UUID
</span></span><span class=line><span class=cl>                <span class=s2>&#34;alterId&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>              <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>]</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;kcp&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;aes-128-gcm&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;kcpSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>				<span class=s2>&#34;mtu&#34;</span>: 1350,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;tti&#34;</span>: 20,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;uplinkCapacity&#34;</span>: 5,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;downlinkCapacity&#34;</span>: 100,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;congestion&#34;</span>: false,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;readBufferSize&#34;</span>: 1,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;writeBufferSize&#34;</span>: 1,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;header&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>					<span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;none&#34;</span>
</span></span><span class=line><span class=cl>				<span class=o>}</span>,
</span></span><span class=line><span class=cl>				<span class=s2>&#34;seed&#34;</span>: <span class=s2>&#34;Password&#34;</span>
</span></span><span class=line><span class=cl>				<span class=o>}</span>
</span></span><span class=line><span class=cl>			<span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=管理v2ray进程>管理V2Ray进程<a hidden class=anchor aria-hidden=true href=#管理v2ray进程>#</a></h2><p>启动</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl start v2ray.service
</span></span></code></pre></div><p>停止</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl stop v2ray.service
</span></span></code></pre></div><p>状态</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl status v2ray.service
</span></span></code></pre></div><p>重启</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl restart v2ray.service
</span></span></code></pre></div><h2 id=日常ssl证书申请的路径>日常SSL证书申请的路径<a hidden class=anchor aria-hidden=true href=#日常ssl证书申请的路径>#</a></h2><h3 id=宝塔nginx的ssl证书路径>宝塔Nginx的SSL证书路径<a hidden class=anchor aria-hidden=true href=#宝塔nginx的ssl证书路径>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/www/server/panel/vhost/cert/example.com/fullchain.pem
</span></span><span class=line><span class=cl>/www/server/panel/vhost/cert/example.com/privkey.pem
</span></span></code></pre></div><p>Caddy1的SSL证书路径</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/etc/ssl/caddy/acme/acme-v02.api.letsencrypt.org/sites/example.com/example.com.crt
</span></span><span class=line><span class=cl>/etc/ssl/caddy/acme/acme-v02.api.letsencrypt.org/sites/example.com/example.com.key
</span></span></code></pre></div><p>Caddy2的SSL证书路径</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/var/lib/caddy/.local/share/caddy/certificates/acme-v02.api.letsencrypt.org-directory/example.com/example.com.crt
</span></span><span class=line><span class=cl>/var/lib/caddy/.local/share/caddy/certificates/acme-v02.api.letsencrypt.org-directory/example.com/example.com.key
</span></span></code></pre></div><p>Certbot的SSL证书路径</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/etc/letsencrypt/live/example.com/fullchain.pem
</span></span><span class=line><span class=cl>/etc/letsencrypt/live/example.com/privkey.pem
</span></span></code></pre></div><p>如果需要配置多个域名证书，可以增加<code>certificates</code>值，例如</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=s2>&#34;certificates&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>			<span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;certificateFile&#34;</span>: <span class=s2>&#34;/path/to/tls1.crt&#34;</span>, // 换成你的证书，绝对路径
</span></span><span class=line><span class=cl>			<span class=s2>&#34;keyFile&#34;</span>: <span class=s2>&#34;/path/to/tls1.key&#34;</span> // 换成你的私钥，绝对路径
</span></span><span class=line><span class=cl>			<span class=o>}</span>,
</span></span><span class=line><span class=cl>			<span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;certificateFile&#34;</span>: <span class=s2>&#34;/path/to/tls2.crt&#34;</span>, // 换成你的证书，绝对路径
</span></span><span class=line><span class=cl>			<span class=s2>&#34;keyFile&#34;</span>: <span class=s2>&#34;/path/to/tls2.key&#34;</span> // 换成你的私钥，绝对路径
</span></span><span class=line><span class=cl>			<span class=o>}</span>,
</span></span><span class=line><span class=cl>			<span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=s2>&#34;certificateFile&#34;</span>: <span class=s2>&#34;/path/to/tls3.crt&#34;</span>, // 换成你的证书，绝对路径
</span></span><span class=line><span class=cl>			<span class=s2>&#34;keyFile&#34;</span>: <span class=s2>&#34;/path/to/tls3.key&#34;</span> // 换成你的私钥，绝对路径
</span></span><span class=line><span class=cl>			<span class=o>}</span>
</span></span><span class=line><span class=cl>		<span class=o>]</span>
</span></span></code></pre></div><h2 id=配置web服务器websocket的规则>配置WEB服务器WebSocket的规则<a hidden class=anchor aria-hidden=true href=#配置web服务器websocket的规则>#</a></h2><p>在配置文件中添加v2ray的WebSocket的规则，然后重启在WEB服务器生效。</p><p>Caddy2</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>@v2ray_websocket <span class=o>{</span>
</span></span><span class=line><span class=cl>    path /ray
</span></span><span class=line><span class=cl>    header Connection *Upgrade*
</span></span><span class=line><span class=cl>    header Upgrade websocket
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>reverse_proxy @v2ray_websocket localhost:22782
</span></span></code></pre></div><p>Caddy</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>    proxy /ray localhost:22782 <span class=o>{</span>
</span></span><span class=line><span class=cl>        websocket
</span></span><span class=line><span class=cl>        header_upstream -Origin
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></div><p>Nginx</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>location /ray <span class=o>{</span>
</span></span><span class=line><span class=cl>    proxy_redirect off<span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_pass http://127.0.0.1:22782<span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_http_version 1.1<span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header Upgrade <span class=nv>$http_upgrade</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header Connection <span class=s2>&#34;upgrade&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_set_header Host <span class=nv>$http_host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    proxy_read_timeout 300s<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></div><p>Apache</p><p>把以下配置加到<code>VirtualHost</code>值</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  &lt;Location <span class=s2>&#34;/ray/&#34;</span>&gt;
</span></span><span class=line><span class=cl>    ProxyPass ws://127.0.0.1:22782/ray/ <span class=nv>upgrade</span><span class=o>=</span>WebSocket
</span></span><span class=line><span class=cl>    ProxyAddHeaders Off
</span></span><span class=line><span class=cl>    ProxyPreserveHost On
</span></span><span class=line><span class=cl>    RequestHeader append X-Forwarded-For %<span class=o>{</span>REMOTE_ADDR<span class=o>}</span>s
</span></span><span class=line><span class=cl>  &lt;/Location&gt;
</span></span></code></pre></div><h2 id=reality>REALITY<a hidden class=anchor aria-hidden=true href=#reality>#</a></h2><p>Reality不支持CDN、不需要配置ssl证书。</p><p>安装最新版本&ndash;beta</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash -c <span class=s2>&#34;</span><span class=k>$(</span>curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh<span class=k>)</span><span class=s2>&#34;</span> @ install -u root  --beta
</span></span></code></pre></div><p>安装预发布版本1.8.0+</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash -c <span class=s2>&#34;</span><span class=k>$(</span>curl -L https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh<span class=k>)</span><span class=s2>&#34;</span> install --version 1.8.0
</span></span></code></pre></div><ul><li>使用<code>xray uuid</code> 生成生成<code>id</code></li><li>使用<code>xray x25519</code>生成<code>Private key</code>和<code>Public key</code></li></ul><p>修改服务端配置文件<code>/usr/local/etc/xray/config.json</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;inbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;listen&#34;</span>: <span class=s2>&#34;0.0.0.0&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;port&#34;</span>: 443,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;vless&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;clients&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                    <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;id&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;flow&#34;</span>: <span class=s2>&#34;xtls-rprx-vision&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>]</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;decryption&#34;</span>: <span class=s2>&#34;none&#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;streamSettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;network&#34;</span>: <span class=s2>&#34;tcp&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;security&#34;</span>: <span class=s2>&#34;reality&#34;</span>,
</span></span><span class=line><span class=cl>                <span class=s2>&#34;realitySettings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;show&#34;</span>: false,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;dest&#34;</span>: <span class=s2>&#34;www.microsoft.com:443&#34;</span>,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xver&#34;</span>: 0,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;serverNames&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;www.iq.com&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;www.microsoft.com&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;www.cloudflare.com&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;www.amazon.com&#34;</span>,
</span></span><span class=line><span class=cl>			<span class=s2>&#34;dl.google.com&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;www.example.com&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>]</span>,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;privateKey&#34;</span>: <span class=s2>&#34;填写privateKey值&#34;</span>,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;minClientVer&#34;</span>: <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;maxClientVer&#34;</span>: <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;maxTimeDiff&#34;</span>: 0,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;shortIds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;0123456789abcdef&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=o>]</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;outbounds&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;protocol&#34;</span>: <span class=s2>&#34;freedom&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;settings&#34;</span>: <span class=o>{}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>目标网站最低标准是支持 TLSv1.3 和 H2 的国外网站</p><p>重启xray</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl <span class=nb>enable</span> xray
</span></span><span class=line><span class=cl>systemctl restart xray
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://567899.xyz/tags/v2ray/>V2ray</a></li></ul><nav class=paginav><a class=prev href=https://567899.xyz/post/glogg-open-large-file-txt/><span class=title>« 上一页</span><br><span>如何打开超大TXT文本文件</span>
</a><a class=next href=https://567899.xyz/post/dujiaoka/><span class=title>下一页 »</span><br><span>纯净Linux系统手工配置独角数卡发卡站点环境</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share V2ray安装配置Vadminss、VLESS、XTLS教程 on x" href="https://x.com/intent/tweet/?text=V2ray%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%aeVadminss%e3%80%81VLESS%e3%80%81XTLS%e6%95%99%e7%a8%8b&amp;url=https%3a%2f%2f567899.xyz%2fpost%2fv2ray%2f&amp;hashtags=V2ray"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share V2ray安装配置Vadminss、VLESS、XTLS教程 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f567899.xyz%2fpost%2fv2ray%2f&amp;title=V2ray%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%aeVadminss%e3%80%81VLESS%e3%80%81XTLS%e6%95%99%e7%a8%8b&amp;summary=V2ray%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%aeVadminss%e3%80%81VLESS%e3%80%81XTLS%e6%95%99%e7%a8%8b&amp;source=https%3a%2f%2f567899.xyz%2fpost%2fv2ray%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share V2ray安装配置Vadminss、VLESS、XTLS教程 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2f567899.xyz%2fpost%2fv2ray%2f&title=V2ray%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%aeVadminss%e3%80%81VLESS%e3%80%81XTLS%e6%95%99%e7%a8%8b"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share V2ray安装配置Vadminss、VLESS、XTLS教程 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f567899.xyz%2fpost%2fv2ray%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share V2ray安装配置Vadminss、VLESS、XTLS教程 on whatsapp" href="https://api.whatsapp.com/send?text=V2ray%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%aeVadminss%e3%80%81VLESS%e3%80%81XTLS%e6%95%99%e7%a8%8b%20-%20https%3a%2f%2f567899.xyz%2fpost%2fv2ray%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share V2ray安装配置Vadminss、VLESS、XTLS教程 on telegram" href="https://telegram.me/share/url?text=V2ray%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%aeVadminss%e3%80%81VLESS%e3%80%81XTLS%e6%95%99%e7%a8%8b&amp;url=https%3a%2f%2f567899.xyz%2fpost%2fv2ray%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share V2ray安装配置Vadminss、VLESS、XTLS教程 on ycombinator" href="https://news.ycombinator.com/submitlink?t=V2ray%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%aeVadminss%e3%80%81VLESS%e3%80%81XTLS%e6%95%99%e7%a8%8b&u=https%3a%2f%2f567899.xyz%2fpost%2fv2ray%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><div id=waline></div><script type=module>
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
    const locale = {
        nick: '昵称(必填)',
        nickError: '请填写昵称',
        mail: '邮箱',
        mailError: '请填写正确的邮件地址',
        link: '网址',
        optional: '可选',
        placeholder: '说点什么吧...\n填写邮箱可收到回复提醒。\n评论区支持 Markdown 语法及预览。\n',
        sofa: '来发评论吧~',
        submit: '提交',
        like: '喜欢',
        cancelLike: '取消喜欢',
        reply: '回复',
        cancelReply: '取消回复',
        comment: '评论',
        refresh: '刷新',
        more: '加载更多...',
        preview: '预览',
        emoji: '表情',
        uploadImage: '上传图片',
        seconds: '秒前',
        minutes: '分钟前',
        hours: '小时前',
        days: '天前',
        now: '刚刚',
        uploading: '正在上传',
        login: '登录',
        logout: '退出',
        admin: '博主',
        sticky: '置顶',
        word: '字',
        wordHint: '评论字数应在 $0 到 $1 字之间！\n当前字数：$2',
        anonymous: '匿名',
        level0: '潜水',
        level1: '冒泡',
        level2: '吐槽',
        level3: '活跃',
        level4: '话痨',
        level5: '传说',
        gif: '表情包',
        gifSearchPlaceholder: '搜索表情包',
        profile: '个人资料',
        approved: '通过',
        waiting: '待审核',
        spam: '垃圾',
        unsticky: '取消置顶',
        oldest: '按倒序',
        latest: '按正序',
        hottest: '按热度',
        reactionTitle: '你认为这篇文章怎么样？',
    };
    init({
        
        el: '#waline',
        serverURL: 'https://comments.567899.xyz',
        locale,
        emoji: true,     
        search: true,    
        reaction: false,  
        requiredMeta: ['nick'],
        pageSize: 10,
        imageUploader: true,
        copyright: true,
        pageview: true,
        like: true,
    });
</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://567899.xyz/>Xizi's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>