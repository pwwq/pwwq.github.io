<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>利用Travis CI和Hugo將Blog自動部署到Github Pages | Xizi's Blog</title>
<meta name=keywords content="Hugo,GitHub"><meta name=description content="個人Blog採用靜態Blog形式託管在[Github][github]上。此前使用的是[Hexo][hexo]，因其包依賴關係複雜，部署流程繁瑣，故將整個部署環境封裝到Docker鏡像中以實現快速部署，但仍較爲繁瑣。現轉用執行速度快、操作簡便的[Hugo][hugo]。本文記錄如何在GNU/Linux中通過[Travis CI][travisci]將[Hugo][hugo]生成的Blog內容自動同步到[Github][github]，實現持續集成、部署。

转载自 利用Travis CI和Hugo將Blog自動部署到Github Pages
官方文檔
本文中的相關操作皆以官方文檔爲操作依據

Github

GitHub Pages Basics
User, Organization, and Project Pages
Creating Project Pages using the command line
Configuring a publishing source for GitHub Pages


Hugo

Host on GitHub


Travis CI

[GitHub Pages Deployment][travisci-github-page]
Building a Python Project
Best Practices in Securing Your Data
Customizing the Build



GitHub Pages 限制

GitHub Pages is a static site hosting service designed to host your personal, organization, or project pages directly from a GitHub repository."><meta name=author content="admin"><link rel=canonical href=https://567899.xyz/post/hugo-travis-ci-deploy-github-pages-automatically/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.59199e9871af4d6eb237b6f7c475938d6aa75124042d2734689caacabadc0c9b.css integrity="sha256-WRmemHGvTW6yN7b3xHWTjWqnUSQELSc0aJyqyrrcDJs=" rel="preload stylesheet" as=style><link rel=icon href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://567899.xyz/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://567899.xyz/post/hugo-travis-ci-deploy-github-pages-automatically/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://567899.xyz/post/hugo-travis-ci-deploy-github-pages-automatically/"><meta property="og:site_name" content="Xizi's Blog"><meta property="og:title" content="利用Travis CI和Hugo將Blog自動部署到Github Pages"><meta property="og:description" content="個人Blog採用靜態Blog形式託管在[Github][github]上。此前使用的是[Hexo][hexo]，因其包依賴關係複雜，部署流程繁瑣，故將整個部署環境封裝到Docker鏡像中以實現快速部署，但仍較爲繁瑣。現轉用執行速度快、操作簡便的[Hugo][hugo]。本文記錄如何在GNU/Linux中通過[Travis CI][travisci]將[Hugo][hugo]生成的Blog內容自動同步到[Github][github]，實現持續集成、部署。
转载自 利用Travis CI和Hugo將Blog自動部署到Github Pages
官方文檔 本文中的相關操作皆以官方文檔爲操作依據
Github GitHub Pages Basics User, Organization, and Project Pages Creating Project Pages using the command line Configuring a publishing source for GitHub Pages Hugo Host on GitHub Travis CI [GitHub Pages Deployment][travisci-github-page] Building a Python Project Best Practices in Securing Your Data Customizing the Build GitHub Pages 限制 GitHub Pages is a static site hosting service designed to host your personal, organization, or project pages directly from a GitHub repository."><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-01-20T01:37:56+08:00"><meta property="article:modified_time" content="2019-01-20T01:37:56+08:00"><meta property="article:tag" content="Hugo"><meta property="article:tag" content="Github"><meta property="og:image" content="https://567899.xyz/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://567899.xyz/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="利用Travis CI和Hugo將Blog自動部署到Github Pages"><meta name=twitter:description content="個人Blog採用靜態Blog形式託管在[Github][github]上。此前使用的是[Hexo][hexo]，因其包依賴關係複雜，部署流程繁瑣，故將整個部署環境封裝到Docker鏡像中以實現快速部署，但仍較爲繁瑣。現轉用執行速度快、操作簡便的[Hugo][hugo]。本文記錄如何在GNU/Linux中通過[Travis CI][travisci]將[Hugo][hugo]生成的Blog內容自動同步到[Github][github]，實現持續集成、部署。

转载自 利用Travis CI和Hugo將Blog自動部署到Github Pages
官方文檔
本文中的相關操作皆以官方文檔爲操作依據

Github

GitHub Pages Basics
User, Organization, and Project Pages
Creating Project Pages using the command line
Configuring a publishing source for GitHub Pages


Hugo

Host on GitHub


Travis CI

[GitHub Pages Deployment][travisci-github-page]
Building a Python Project
Best Practices in Securing Your Data
Customizing the Build



GitHub Pages 限制

GitHub Pages is a static site hosting service designed to host your personal, organization, or project pages directly from a GitHub repository."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://567899.xyz/post/"},{"@type":"ListItem","position":2,"name":"利用Travis CI和Hugo將Blog自動部署到Github Pages","item":"https://567899.xyz/post/hugo-travis-ci-deploy-github-pages-automatically/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"利用Travis CI和Hugo將Blog自動部署到Github Pages","name":"利用Travis CI和Hugo將Blog自動部署到Github Pages","description":"個人Blog採用靜態Blog形式託管在[Github][github]上。此前使用的是[Hexo][hexo]，因其包依賴關係複雜，部署流程繁瑣，故將整個部署環境封裝到Docker鏡像中以實現快速部署，但仍較爲繁瑣。現轉用執行速度快、操作簡便的[Hugo][hugo]。本文記錄如何在GNU/Linux中通過[Travis CI][travisci]將[Hugo][hugo]生成的Blog內容自動同步到[Github][github]，實現持續集成、部署。\n转载自 利用Travis CI和Hugo將Blog自動部署到Github Pages\n官方文檔 本文中的相關操作皆以官方文檔爲操作依據\nGithub GitHub Pages Basics User, Organization, and Project Pages Creating Project Pages using the command line Configuring a publishing source for GitHub Pages Hugo Host on GitHub Travis CI [GitHub Pages Deployment][travisci-github-page] Building a Python Project Best Practices in Securing Your Data Customizing the Build GitHub Pages 限制 GitHub Pages is a static site hosting service designed to host your personal, organization, or project pages directly from a GitHub repository.\n","keywords":["Hugo","GitHub"],"articleBody":"個人Blog採用靜態Blog形式託管在[Github][github]上。此前使用的是[Hexo][hexo]，因其包依賴關係複雜，部署流程繁瑣，故將整個部署環境封裝到Docker鏡像中以實現快速部署，但仍較爲繁瑣。現轉用執行速度快、操作簡便的[Hugo][hugo]。本文記錄如何在GNU/Linux中通過[Travis CI][travisci]將[Hugo][hugo]生成的Blog內容自動同步到[Github][github]，實現持續集成、部署。\n转载自 利用Travis CI和Hugo將Blog自動部署到Github Pages\n官方文檔 本文中的相關操作皆以官方文檔爲操作依據\nGithub GitHub Pages Basics User, Organization, and Project Pages Creating Project Pages using the command line Configuring a publishing source for GitHub Pages Hugo Host on GitHub Travis CI [GitHub Pages Deployment][travisci-github-page] Building a Python Project Best Practices in Securing Your Data Customizing the Build GitHub Pages 限制 GitHub Pages is a static site hosting service designed to host your personal, organization, or project pages directly from a GitHub repository.\nGitHub Pages 站點在使用上有如下限制：\n倉庫大小不得超過1GB； 生成的 GitHub Pages 站點大小不得超過1 GB； GitHub Pages 站點每月限 100 GB 流量； GitHub Pages 站點每小時限構建10次； 更多介紹見官方文檔 『What is GitHub Pages?』。\n準備工作 在[Github][github]註冊帳號； 在[Travis CI][travisci]註冊帳號(可通過Github帳號登入)； 本地系統安裝git，hugo； 個人域名(可選，此處指定域名axdlog.com)； 安裝 Hugo Github 地址: https://github.com/gohugoio/hugo 下載頁: https://github.com/gohugoio/hugo/releases 版本信息API: https://api.github.com/repos/gohugoio/hugo/releases/latest hugo官方的安裝文檔頁Install Hugo，如果使用GNU/Linux，可考慮使用本人寫的Python腳本進行快速安裝。\n查看版本信息\n# which hugo /usr/local/bin/hugo # hugo version Hugo Static Site Generator v0.55.5-A83256B9 linux/amd64 BuildDate: 2019-05-02T13:03:36Z Python Script 這個Python腳本用於安裝或升級 GNU/Linux 中的Hugo。\n操作過程\n$ sudo python3 ~/hugo.py uccessfully download pack /tmp/hugo_0.55.4_Linux-64bit.tar.gz! Successfully install Hugo v0.55.4! Symlink info: lrwxrwxrwx 1 root root 14 Apr 26 12:26 /usr/local/bin/hugo -\u003e /opt/Hugo/hugo Hugo info: Hugo Static Site Generator v0.55.4-57900417 linux/amd64 BuildDate: 2019-04-25T07:38:50Z $ sudo python3 ~/hugo.py Latest version 0.55.4 existed. Hugo info: Hugo Static Site Generator v0.55.4-57900417 linux/amd64 BuildDate: 2019-04-25T07:38:50Z # update operation $ sudo python3 hugo.py Local version 0.55.4 \u003c latest version 0.55.5. Successfully download pack /tmp/hugo_0.55.5_Linux-64bit.tar.gz! Successfully install Hugo v0.55.5! Symlink info: lrwxrwxrwx 1 root root 14 May 2 11:21 /usr/local/bin/hugo -\u003e /opt/Hugo/hugo Hugo info: Hugo Static Site Generator v0.55.5-A83256B9 linux/amd64 BuildDate: 2019-05-02T13:03:36Z 創建新項目 如何通過[Hugo][hugo]創建一個新的站點，詳見官方文檔 Get Started、Quick Start。\nIf this is your first time using Hugo and you’ve already installed Hugo on your machine, we recommend the quick start.\n此處且將站點名稱命名爲quickstart(其實就是目錄名，不一定是最終的網站名稱)。\nhugo new site quickstart Hugo生成的目錄結構如下\n# tree -L 2 ├── archetypes │ └── default.md ├── config.toml ├── content ├── data ├── layouts ├── static └── themes 6 directories, 2 files 注意：這些不是最終的Blog內容，是用於生成Blog內容的文件。\n目錄content中存放自己需要發佈的Blog (Markdown文件)；\n如果要預覽Blog最終效果，可通過命令hugo server在本地開啓一個Web服務器，端口號1313，在瀏覽器中打開即可。\nWeb Server is available at http://localhost:1313/ (bind address 127.0.0.1) Press Ctrl+C to stop 在項目所在目錄中執行命令hugo，會生成名爲public的目錄，該目錄存放着最終的Blog內容文件。將public目錄中的所有內容上傳至Github的master分支中即可。\n演示過程如下\n# hugo | EN +------------------+-----+ Pages | 426 Paginator pages | 24 Non-page files | 0 Static files | 34 Processed images | 0 Aliases | 95 Sitemaps | 1 Cleaned | 0 Total in 403 ms # tree -L 1 . ├── archetypes ├── config.toml ├── content ├── data ├── layouts ├── public ├── resources ├── static └── themes 8 directories, 1 file 配置 Github 倉庫 注意：本部分的處理思路、操作非常重要，Git配置步驟省略。Git的使用見官方文檔 『GitHub Help』、『Git Cheat Sheets』。\n使用GitHub Pages託管Blog內容，需要創建名爲.github.io的倉庫，並將Hugo生成的Blog內容提交到倉庫的master中。\n因Hugo生成的內容分爲兩部分，源文件和public目錄中的Blog內容。故通過git checkout --orphan在同一倉庫中創建2個分支：\n分支code用於存放源文件； 分支master用於存放public目錄中的Blog內容； 處理思路與官方文檔 Configuring a publishing source for GitHub Pages不同，需要注意。\n創建空倉庫 本人GitHub帳號名爲MaxdSre，故創建倉庫maxdsre.github.io。\n創建倉庫後，出現如下提示信息\nor create a new repository on the command line\necho \"# maxdsre.github.io\" \u003e\u003e README.md git init git add README.md git commit -m \"first commit\" git remote add origin git@github.com:MaxdSre/maxdsre.github.io.git git push -u origin master or push an existing repository from the command line\ngit remote add origin git@github.com:MaxdSre/maxdsre.github.io.git git push -u origin master 分支操作 操作分爲4步：\n初始化Git倉庫(git init)； 創建code分支，提交源文件代碼到倉庫； 在目標目錄中執行hugo生成public目錄，將public目錄中內容轉移到臨時目錄中， 清空目標目錄，將臨時目錄中文件複製到該目錄中； 通過命令git checkout --orphan創建master分支，將目錄中內容提交到倉庫。 進入目標目錄（此處爲/PATH/quickstart/）後，順序執行如下操作命令\ncode 分支 # Initialized empty Git repository in /PATH/.git/ git init # Switched to a new branch 'code', equal to 'git branch code \u0026\u0026 git checkout code' git checkout -b code # exclude dir public/ echo '/public/' \u003e\u003e .gitignore sed -r -i '/^\\/public\\/$/{$!d}' .gitignore # Add file contents to the index git add . # Show the working tree status # git status # Record changes to the repository git commit -m \"Hugo generator code\" # Manage set of tracked repositories git remote add origin git@github.com:MaxdSre/maxdsre.github.io.git # Update remote refs along with associated objects to branch 'code' git push -u origin code master 分支 在目錄中執行hugo生成public目錄。通過命令git branch -a可查看倉庫的分支信息。\n# execute command hugo hugo # create temporary dir HUGO_TEMP_DIR=$(mktemp -d) cp -R public/* \"$HUGO_TEMP_DIR\" # create orphan branch 'master' git checkout --orphan master # empty current dir rm .git/index git clean -fdx # copy back contents in dir public/ cp -R \"$HUGO_TEMP_DIR\"/. . # add, commit, push git add . # git status git commit -m 'initial blog content' git push -u origin master # remove temp dir [[ -d \"$HUGO_TEMP_DIR\" ]] \u0026\u0026 rm -rf \"$HUGO_TEMP_DIR\" image 分支 此操作爲可選操作，本人創建第3個分支image用作圖牀，本文中的圖片即存放在該分支中。\n注：[GitHub][github]每個倉庫可使用 1 GB 存儲空間，單個文件大小不超過 100 MB，詳見官方文檔 『File and repository size limitations』。\ngit checkout --orphan image rm .git/index git clean -fdx # add content to this branch git add . git commit -m 'initial blog images' git push -u origin image # fatal: The current branch image has no upstream branch. # To push the current branch and set the remote as upstream, use # git push --set-upstream origin image 切換分支 如果要將本地分支切換到遠程分支remotes/origin/image，可通過如下命令實現\n# git checkout -b --track / # -b Create a new branch named and start it at ; # -t, --track When creating a new branch, set up \"upstream\" configuration. git checkout -t remotes/origin/image # 本地分支，從其它分支切換到本地分支code git checkout code 演示過程如下\n$ git branch * code $ git branch -a * code remotes/origin/HEAD -\u003e origin/code remotes/origin/code remotes/origin/image remotes/origin/master $ git checkout -t remotes/origin/image Branch 'image' set up to track remote branch 'image' from 'origin'. Switched to a new branch 'image' $ git branch code * image $ git branch -a code * image remotes/origin/HEAD -\u003e origin/code remotes/origin/code remotes/origin/image remotes/origin/master 此處遠程默認分支爲code，如果需要更改爲master，執行如下命令\n# change HEAD from origin/code to origin/master git remote set-head origin master 刪除分支 可分爲刪除遠程分支、本地分支、追蹤分支三種情況，具體見How do I delete a Git branch both locally and remotely?。\n# 1 - 刪除遠程分支 $ git push origin --delete # Git version 1.7.0 or newer $ git push origin : # Git versions older than 1.7.0 # 2 - 刪除本地分支 $ git branch --delete $ git branch -d # Shorter version $ git branch -D # Force delete un-merged branches # error: The branch 'image' is not fully merged. # If you are sure you want to delete it, run 'git branch -D image'. # 3 - 刪除本地追蹤分支 $ git branch --delete --remotes / $ git branch -dr / # Shorter $ git fetch --prune # Delete multiple obsolete tracking branches $ git fetch -p # Shorter Travis CI 配置 [Travis CI][travisci]官方說明文檔 [GitHub Pages Deployment][travisci-github-page]。\n生成 Github 訪問 Token You’ll need to generate a personal access token with the public_repo or repo scope (repo is required for private repositories). Since the token should be private, you’ll want to pass it to Travis securely in your repository settings or via encrypted variables in .travis.yml.\n在Github的Developer settings頁面中生成personal access tokens，若是私有倉庫，勾選repo；若是公開倉庫，勾選public_repo。此處本人選擇了 public_repo, repo:status, repo_deployment三項。\n生成的是長度爲40的隨機字符串，注意請勿泄漏。\n設置環境變量 生成的token須在[Travis CI][travisci]的目標Repo中設置，頁面地址爲 https://travis-ci.org/MaxdSre/maxdsre.github.io/settings。\n確保General中的Build only if .travis.yml is present, Build pushed branches, Build pushed pull requests已啓用。\n官方文檔[GitHub Pages Deployment][travisci-github-page]定義的默認token名爲GITHUB_TOKEN，其它指令詳見文檔。\nNotice that the values are not escaped when your builds are executed. Special characters (for bash) should be escaped accordingly.\n此處定義相關變量，稍後會寫入.travis.yml文件。\nEnvironment Variables Value CNAME_URL axdlog.com GITHUB_USERNAME MaxdSre GITHUB_EMAIL admin@axdlog.com (假設值) GITHUB_TOKEN 75e8b72618ebf48df0b235cp4affd79e167b2489 (假設值) .travis.yml 指令 [Hugo][hugo]是用Golang構建的，如果在.travis.yml中使用language: go，[Travis CI][travisci]構建Golang環境耗時太長(數分鐘)。\n看到他人教程中有用Python的，恰巧最近在學習Python，便選擇Python做爲構建環境。因[Travis CI][travisci]的容器環境是基於Ubuntu的，故可以使用dpkg、apt-get等命令，但需要添加sudo。\n使用Python經常出現構建失敗的情況，原因是GitHub禁止Travis容器的HTTP請求，通過tor代理解決。\n最終指令如下\nPython # https://docs.travis-ci.com/user/deployment/pages/ # https://docs.travis-ci.com/user/reference/xenial/ # https://docs.travis-ci.com/user/languages/python/ # https://docs.travis-ci.com/user/customizing-the-build/ dist: xenial language: python python: - \"3.7\" before_install: - sudo apt-get update -qq - sudo apt-get -yq install apt-transport-https tor curl # install - install any dependencies required install: # install latest release version # Github may forbid request from travis container, so use tor proxy - sudo systemctl start tor # - curl -fsL --socks5-hostname 127.0.0.1:9050 https://api.github.com/repos/gohugoio/hugo/releases/latest | sed -r -n '/browser_download_url/{/Linux-64bit.deb/{s@[^:]*:[[:space:]]*\"([^\"]*)\".*@\\1@g;p;q}}' | xargs wget - download_command='curl -fsSL -x socks5h://127.0.0.1:9050' # --socks5-hostname - $download_command -O $($download_command https://api.github.com/repos/gohugoio/hugo/releases/latest | sed -r -n '/browser_download_url/{/Linux-64bit.deb/{s@[^:]*:[[:space:]]*\"([^\"]*)\".*@\\1@g;p;q}}') - sudo dpkg -i hugo*.deb - rm -rf public 2\u003e /dev/null # script - run the build script script: - hugo 2\u003e /dev/null - echo \"$CNAME_URL\" \u003e public/CNAME deploy: provider: pages skip-cleanup: true github-token: $GITHUB_TOKEN # Set in travis-ci.org dashboard, marked secure email: $GITHUB_EMAIL name: $GITHUB_USERNAME verbose: true keep-history: true local-dir: public target_branch: master # branch contains blog content on: branch: code # branch contains Hugo generator code Golang (deprecated) # https://docs.travis-ci.com/user/deployment/pages/ # https://docs.travis-ci.com/user/reference/xenial/ # https://docs.travis-ci.com/user/languages/go/ # https://docs.travis-ci.com/user/customizing-the-build/ dist: xenial language: go go: - master # before_install # install - install any dependencies required install: - go get github.com/gohugoio/hugo # consume time 70.85s before_script: - rm -rf public 2\u003e /dev/null # script - run the build script script: - hugo 2\u003e /dev/null - echo \"$CNAME_URL\" \u003e public/CNAME deploy: provider: pages skip-cleanup: true github-token: $GITHUB_TOKEN # Set in travis-ci.org dashboard, marked secure email: $GITHUB_EMAIL name: $GITHUB_USERNAME verbose: true keep-history: true local-dir: public target_branch: master # branch contains blog content on: branch: code # branch contains Hugo generator code 將指令寫入到文件.travis.yml中，並將該.travis.yml上傳至repo的code分支中。\n持續集成 所有操作完成後，只需將需要發佈的Blog上傳到repo的code分支中，[Travis CI][travisci]會自動進行部署操作，將更新的Blog內容更新到repo的master分支中，實現Blog的持續集成，自動部署。\n部署過程日誌\n參考資料 Continuous Integration of Hugo Website using Travis CI and Github Travis continuous delivery How to create a website like freshswift.net using Hugo, Travis CI, and GitHub Pages GitLab CI remove priority zero from Hugo sitemap Deploy Hugo site to Github Pages with Travis CI ","wordCount":"1402","inLanguage":"zh","image":"https://567899.xyz/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2019-01-20T01:37:56+08:00","dateModified":"2019-01-20T01:37:56+08:00","author":{"@type":"Person","name":"admin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://567899.xyz/post/hugo-travis-ci-deploy-github-pages-automatically/"},"publisher":{"@type":"Organization","name":"Xizi's Blog","logo":{"@type":"ImageObject","url":"https://567899.xyz/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://567899.xyz/ accesskey=h title="Xizi's Blog (Alt + H)"><img src=https://567899.xyz/apple-touch-icon.png alt aria-label=logo height=35>Xizi's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://567899.xyz/archives/ title=归档><span>归档</span></a></li><li><a href=https://567899.xyz/tags/ title=标签><span>标签</span></a></li><li><a href=https://567899.xyz/about/ title=关于><span>关于</span></a></li><li><a href=https://567899.xyz/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://567899.xyz/>主页</a>&nbsp;»&nbsp;<a href=https://567899.xyz/post/>Posts</a></div><h1 class="post-title entry-hint-parent">利用Travis CI和Hugo將Blog自動部署到Github Pages</h1><div class=post-meta><span title='2019-01-20 01:37:56 +0800 +0800'>一月 20, 2019</span>&nbsp;·&nbsp;admin&nbsp;|&nbsp;<a href=https://github.com/pwwq/hugo-code/tree/master/content/post/Hugo-Travis-CI-Deploy-Github-Pages-Automatically.md rel="noopener noreferrer" target=_blank>编辑</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#官方文檔>官方文檔</a></li><li><a href=#github-pages-限制>GitHub Pages 限制</a></li><li><a href=#準備工作>準備工作</a></li><li><a href=#安裝-hugo>安裝 Hugo</a></li><li><a href=#python-script>Python Script</a></li><li><a href=#創建新項目>創建新項目</a></li><li><a href=#配置-github-倉庫>配置 Github 倉庫</a></li><li><a href=#創建空倉庫>創建空倉庫</a></li><li><a href=#分支操作>分支操作</a><ul><li><a href=#code-分支>code 分支</a></li><li><a href=#master-分支>master 分支</a></li><li><a href=#image-分支>image 分支</a></li></ul></li><li><a href=#切換分支>切換分支</a></li><li><a href=#刪除分支>刪除分支</a></li><li><a href=#travis-ci-配置>Travis CI 配置</a></li><li><a href=#生成-github-訪問-token>生成 Github 訪問 Token</a></li><li><a href=#設置環境變量>設置環境變量</a></li><li><a href=#travisyml-指令>.travis.yml 指令</a><ul><li><a href=#python>Python</a></li><li><a href=#golang-deprecated>Golang (deprecated)</a></li></ul></li><li><a href=#持續集成>持續集成</a></li><li><a href=#參考資料>參考資料</a></li></ul></nav></div></details></div><div class=post-content><p>個人Blog採用靜態Blog形式託管在[Github][github]上。此前使用的是[Hexo][hexo]，因其包依賴關係複雜，部署流程繁瑣，故將整個部署環境封裝到Docker鏡像中以實現快速部署，但仍較爲繁瑣。現轉用執行速度快、操作簡便的[Hugo][hugo]。本文記錄如何在GNU/Linux中通過[Travis CI][travisci]將[Hugo][hugo]生成的Blog內容自動同步到[Github][github]，實現持續集成、部署。</p><blockquote><p>转载自 <a href=https://axdlog.com/zh/2018/using-hugo-and-travis-ci-to-deploy-blog-to-github-pages-automatically/>利用Travis CI和Hugo將Blog自動部署到Github Pages</a></p></blockquote><h2 id=官方文檔>官方文檔<a hidden class=anchor aria-hidden=true href=#官方文檔>#</a></h2><p>本文中的相關操作皆以官方文檔爲操作依據</p><ul><li>Github<ul><li><a href=https://help.github.com/categories/github-pages-basics/>GitHub Pages Basics</a></li><li><a href=https://help.github.com/articles/user-organization-and-project-pages/>User, Organization, and Project Pages</a></li><li><a href=https://help.github.com/articles/creating-project-pages-using-the-command-line/>Creating Project Pages using the command line</a></li><li><a href=https://help.github.com/articles/configuring-a-publishing-source-for-github-pages/>Configuring a publishing source for GitHub Pages</a></li></ul></li><li>Hugo<ul><li><a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/>Host on GitHub</a></li></ul></li><li>Travis CI<ul><li>[GitHub Pages Deployment][travisci-github-page]</li><li><a href=https://docs.travis-ci.com/user/languages/python/>Building a Python Project</a></li><li><a href=https://docs.travis-ci.com/user/best-practices-security/>Best Practices in Securing Your Data</a></li><li><a href=https://docs.travis-ci.com/user/customizing-the-build/>Customizing the Build</a></li></ul></li></ul><h2 id=github-pages-限制>GitHub Pages 限制<a hidden class=anchor aria-hidden=true href=#github-pages-限制>#</a></h2><blockquote><p>GitHub Pages is a static site hosting service designed to host your personal, organization, or project pages directly from a GitHub repository.</p></blockquote><p>GitHub Pages 站點在使用上有如下限制：</p><ol><li>倉庫大小<a href=https://help.github.com/en/articles/what-is-my-disk-quota#file-and-repository-size-limitations>不得超過1GB</a>；</li><li>生成的 GitHub Pages 站點大小不得超過1 GB；</li><li>GitHub Pages 站點每月限 100 GB 流量；</li><li>GitHub Pages 站點每小時限構建10次；</li></ol><p>更多介紹見官方文檔 『<a href=https://help.github.com/en/articles/what-is-github-pages>What is GitHub Pages?</a>』。</p><h2 id=準備工作>準備工作<a hidden class=anchor aria-hidden=true href=#準備工作>#</a></h2><ol><li>在[Github][github]註冊帳號；</li><li>在[Travis CI][travisci]註冊帳號(可通過Github帳號登入)；</li><li>本地系統安裝<code>git</code>，<code>hugo</code>；</li><li>個人域名(可選，此處指定域名<code>axdlog.com</code>)；</li></ol><h2 id=安裝-hugo>安裝 Hugo<a hidden class=anchor aria-hidden=true href=#安裝-hugo>#</a></h2><ul><li>Github 地址: <a href=https://github.com/gohugoio/hugo>https://github.com/gohugoio/hugo</a></li><li>下載頁: <a href=https://github.com/gohugoio/hugo/releases>https://github.com/gohugoio/hugo/releases</a></li><li>版本信息API: <a href=https://api.github.com/repos/gohugoio/hugo/releases/latest>https://api.github.com/repos/gohugoio/hugo/releases/latest</a></li></ul><p>hugo官方的安裝文檔頁<a href=https://gohugo.io/getting-started/installing/>Install Hugo</a>，如果使用GNU/Linux，可考慮使用本人寫的Python腳本進行快速安裝。</p><p>查看版本信息</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># which hugo</span>
</span></span><span class=line><span class=cl>/usr/local/bin/hugo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># hugo version</span>
</span></span><span class=line><span class=cl>Hugo Static Site Generator v0.55.5-A83256B9 linux/amd64 BuildDate: 2019-05-02T13:03:36Z
</span></span></code></pre></div><h2 id=python-script>Python Script<a hidden class=anchor aria-hidden=true href=#python-script>#</a></h2><p>這個Python腳本用於安裝或升級 GNU/Linux 中的Hugo。</p><p>操作過程</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo python3 ~/hugo.py
</span></span><span class=line><span class=cl>uccessfully download pack /tmp/hugo_0.55.4_Linux-64bit.tar.gz!
</span></span><span class=line><span class=cl>Successfully install Hugo v0.55.4!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Symlink info:
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root <span class=m>14</span> Apr <span class=m>26</span> 12:26 /usr/local/bin/hugo -&gt; /opt/Hugo/hugo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hugo info:
</span></span><span class=line><span class=cl>Hugo Static Site Generator v0.55.4-57900417 linux/amd64 BuildDate: 2019-04-25T07:38:50Z
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sudo python3 ~/hugo.py
</span></span><span class=line><span class=cl>Latest version 0.55.4 existed.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hugo info:
</span></span><span class=line><span class=cl>Hugo Static Site Generator v0.55.4-57900417 linux/amd64 BuildDate: 2019-04-25T07:38:50Z
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># update operation</span>
</span></span><span class=line><span class=cl>$ sudo python3 hugo.py
</span></span><span class=line><span class=cl>Local version 0.55.4 &lt; latest version 0.55.5.
</span></span><span class=line><span class=cl>Successfully download pack /tmp/hugo_0.55.5_Linux-64bit.tar.gz!
</span></span><span class=line><span class=cl>Successfully install Hugo v0.55.5!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Symlink info:
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root <span class=m>14</span> May  <span class=m>2</span> 11:21 /usr/local/bin/hugo -&gt; /opt/Hugo/hugo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hugo info:
</span></span><span class=line><span class=cl>Hugo Static Site Generator v0.55.5-A83256B9 linux/amd64 BuildDate: 2019-05-02T13:03:36Z
</span></span></code></pre></div><h2 id=創建新項目>創建新項目<a hidden class=anchor aria-hidden=true href=#創建新項目>#</a></h2><p>如何通過[Hugo][hugo]創建一個新的站點，詳見官方文檔 <a href=https://gohugo.io/getting-started/>Get Started</a>、<a href=https://gohugo.io/getting-started/quick-start/>Quick Start</a>。</p><blockquote><p>If this is your first time using Hugo and you’ve <a href=https://gohugo.io/getting-started/installing/>already installed Hugo on your machine</a>, we recommend the <a href=https://gohugo.io/getting-started/quick-start/>quick start</a>.</p></blockquote><p>此處且將站點名稱命名爲<code>quickstart</code>(其實就是目錄名，不一定是最終的網站名稱)。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo new site quickstart
</span></span></code></pre></div><p>Hugo生成的目錄結構如下</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># tree -L 2</span>
</span></span><span class=line><span class=cl>├── archetypes
</span></span><span class=line><span class=cl>│   └── default.md
</span></span><span class=line><span class=cl>├── config.toml
</span></span><span class=line><span class=cl>├── content
</span></span><span class=line><span class=cl>├── data
</span></span><span class=line><span class=cl>├── layouts
</span></span><span class=line><span class=cl>├── static
</span></span><span class=line><span class=cl>└── themes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>6</span> directories, <span class=m>2</span> files
</span></span></code></pre></div><p><strong>注意</strong>：這些不是最終的Blog內容，是用於生成Blog內容的文件。</p><p>目錄<code>content</code>中存放自己需要發佈的Blog (Markdown文件)；</p><p>如果要預覽Blog最終效果，可通過命令<code>hugo server</code>在本地開啓一個Web服務器，端口號<code>1313</code>，在瀏覽器中打開即可。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Web Server is available at http://localhost:1313/ <span class=o>(</span><span class=nb>bind</span> address 127.0.0.1<span class=o>)</span>
</span></span><span class=line><span class=cl>Press Ctrl+C to stop
</span></span></code></pre></div><p>在項目所在目錄中執行命令<code>hugo</code>，會生成名爲<code>public</code>的目錄，該目錄存放着最終的Blog內容文件。將<code>public</code>目錄中的所有內容上傳至Github的<code>master</code>分支中即可。</p><p>演示過程如下</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># hugo</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                   <span class=p>|</span> EN   
</span></span><span class=line><span class=cl>+------------------+-----+
</span></span><span class=line><span class=cl>  Pages            <span class=p>|</span> <span class=m>426</span>  
</span></span><span class=line><span class=cl>  Paginator pages  <span class=p>|</span>  <span class=m>24</span>  
</span></span><span class=line><span class=cl>  Non-page files   <span class=p>|</span>   <span class=m>0</span>  
</span></span><span class=line><span class=cl>  Static files     <span class=p>|</span>  <span class=m>34</span>  
</span></span><span class=line><span class=cl>  Processed images <span class=p>|</span>   <span class=m>0</span>  
</span></span><span class=line><span class=cl>  Aliases          <span class=p>|</span>  <span class=m>95</span>  
</span></span><span class=line><span class=cl>  Sitemaps         <span class=p>|</span>   <span class=m>1</span>  
</span></span><span class=line><span class=cl>  Cleaned          <span class=p>|</span>   <span class=m>0</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Total in <span class=m>403</span> ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># tree -L 1</span>
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── archetypes
</span></span><span class=line><span class=cl>├── config.toml
</span></span><span class=line><span class=cl>├── content
</span></span><span class=line><span class=cl>├── data
</span></span><span class=line><span class=cl>├── layouts
</span></span><span class=line><span class=cl>├── public
</span></span><span class=line><span class=cl>├── resources
</span></span><span class=line><span class=cl>├── static
</span></span><span class=line><span class=cl>└── themes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>8</span> directories, <span class=m>1</span> file
</span></span></code></pre></div><h2 id=配置-github-倉庫>配置 Github 倉庫<a hidden class=anchor aria-hidden=true href=#配置-github-倉庫>#</a></h2><p><strong>注意</strong>：本部分的處理思路、操作非常重要，Git配置步驟省略。Git的使用見官方文檔 『<a href=https://help.github.com/en>GitHub Help</a>』、『<a href=https://github.github.com/training-kit/>Git Cheat Sheets</a>』。</p><p>使用GitHub Pages託管Blog內容，需要創建名爲<code>&lt;username>.github.io</code>的倉庫，並將Hugo生成的Blog內容提交到倉庫的<code>master</code>中。</p><p>因Hugo生成的內容分爲兩部分，源文件和<code>public</code>目錄中的Blog內容。故通過<code>git checkout --orphan</code>在同一倉庫中創建2個分支：</p><ul><li>分支<code>code</code>用於存放源文件；</li><li>分支<code>master</code>用於存放<code>public</code>目錄中的Blog內容；</li></ul><p>處理思路與官方文檔 <a href=https://help.github.com/articles/configuring-a-publishing-source-for-github-pages/>Configuring a publishing source for GitHub Pages</a>不同，需要注意。</p><h2 id=創建空倉庫>創建空倉庫<a hidden class=anchor aria-hidden=true href=#創建空倉庫>#</a></h2><p>本人GitHub帳號名爲<code>MaxdSre</code>，故創建倉庫<code>maxdsre.github.io</code>。</p><p>創建倉庫後，出現如下提示信息</p><blockquote><p>or create a new repository on the command line</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;# maxdsre.github.io&#34;</span> &gt;&gt; README.md
</span></span><span class=line><span class=cl>git init
</span></span><span class=line><span class=cl>git add README.md
</span></span><span class=line><span class=cl>git commit -m <span class=s2>&#34;first commit&#34;</span>
</span></span><span class=line><span class=cl>git remote add origin git@github.com:MaxdSre/maxdsre.github.io.git
</span></span><span class=line><span class=cl>git push -u origin master
</span></span></code></pre></div><blockquote><p>or push an existing repository from the command line</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git remote add origin git@github.com:MaxdSre/maxdsre.github.io.git
</span></span><span class=line><span class=cl>git push -u origin master
</span></span></code></pre></div><h2 id=分支操作>分支操作<a hidden class=anchor aria-hidden=true href=#分支操作>#</a></h2><p>操作分爲4步：</p><ol><li>初始化Git倉庫(<code>git init</code>)；</li><li>創建<code>code</code>分支，提交源文件代碼到倉庫；</li><li>在目標目錄中執行<code>hugo</code>生成<code>public</code>目錄，將<code>public</code>目錄中內容轉移到臨時目錄中， 清空目標目錄，將臨時目錄中文件複製到該目錄中；</li><li>通過命令<code>git checkout --orphan</code>創建<code>master</code>分支，將目錄中內容提交到倉庫。</li></ol><p>進入目標目錄（此處爲<code>/PATH/quickstart/</code>）後，順序執行如下操作命令</p><h3 id=code-分支>code 分支<a hidden class=anchor aria-hidden=true href=#code-分支>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Initialized empty Git repository in /PATH/.git/</span>
</span></span><span class=line><span class=cl>git init
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Switched to a new branch &#39;code&#39;, equal to &#39;git branch code &amp;&amp; git checkout code&#39;</span>
</span></span><span class=line><span class=cl>git checkout -b code
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># exclude dir public/</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;/public/&#39;</span> &gt;&gt; .gitignore
</span></span><span class=line><span class=cl>sed -r -i <span class=s1>&#39;/^\/public\/$/{$!d}&#39;</span> .gitignore
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add file contents to the index</span>
</span></span><span class=line><span class=cl>git add .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Show the working tree status</span>
</span></span><span class=line><span class=cl><span class=c1># git status</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Record changes to the repository</span>
</span></span><span class=line><span class=cl>git commit -m <span class=s2>&#34;Hugo generator code&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Manage set of tracked repositories</span>
</span></span><span class=line><span class=cl>git remote add origin git@github.com:MaxdSre/maxdsre.github.io.git
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Update remote refs along with associated objects to branch &#39;code&#39;</span>
</span></span><span class=line><span class=cl>git push -u origin code
</span></span></code></pre></div><h3 id=master-分支>master 分支<a hidden class=anchor aria-hidden=true href=#master-分支>#</a></h3><p>在目錄中執行<code>hugo</code>生成<code>public</code>目錄。通過命令<code>git branch -a</code>可查看倉庫的分支信息。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># execute command hugo</span>
</span></span><span class=line><span class=cl>hugo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># create temporary dir</span>
</span></span><span class=line><span class=cl><span class=nv>HUGO_TEMP_DIR</span><span class=o>=</span><span class=k>$(</span>mktemp -d<span class=k>)</span>
</span></span><span class=line><span class=cl>cp -R public/* <span class=s2>&#34;</span><span class=nv>$HUGO_TEMP_DIR</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># create orphan branch &#39;master&#39;</span>
</span></span><span class=line><span class=cl>git checkout --orphan master
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># empty current dir</span>
</span></span><span class=line><span class=cl>rm .git/index
</span></span><span class=line><span class=cl>git clean -fdx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># copy back contents in dir public/</span>
</span></span><span class=line><span class=cl>cp -R <span class=s2>&#34;</span><span class=nv>$HUGO_TEMP_DIR</span><span class=s2>&#34;</span>/. .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># add, commit, push</span>
</span></span><span class=line><span class=cl>git add .
</span></span><span class=line><span class=cl><span class=c1># git status</span>
</span></span><span class=line><span class=cl>git commit -m <span class=s1>&#39;initial blog content&#39;</span>
</span></span><span class=line><span class=cl>git push -u origin master
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># remove temp dir</span>
</span></span><span class=line><span class=cl><span class=o>[[</span> -d <span class=s2>&#34;</span><span class=nv>$HUGO_TEMP_DIR</span><span class=s2>&#34;</span> <span class=o>]]</span> <span class=o>&amp;&amp;</span> rm -rf <span class=s2>&#34;</span><span class=nv>$HUGO_TEMP_DIR</span><span class=s2>&#34;</span>
</span></span></code></pre></div><h3 id=image-分支>image 分支<a hidden class=anchor aria-hidden=true href=#image-分支>#</a></h3><p>此操作爲可選操作，本人創建第3個分支<code>image</code>用作圖牀，本文中的圖片即存放在該分支中。</p><p><strong>注</strong>：[GitHub][github]每個倉庫可使用 <strong>1 GB</strong> 存儲空間，單個文件大小不超過 <strong>100 MB</strong>，詳見官方文檔 『<a href=https://help.github.com/en/articles/what-is-my-disk-quota#file-and-repository-size-limitations>File and repository size limitations</a>』。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git checkout --orphan image
</span></span><span class=line><span class=cl>rm .git/index
</span></span><span class=line><span class=cl>git clean -fdx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># add content to this branch</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>git add .
</span></span><span class=line><span class=cl>git commit -m <span class=s1>&#39;initial blog images&#39;</span>
</span></span><span class=line><span class=cl>git push -u origin image
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># fatal: The current branch image has no upstream branch.</span>
</span></span><span class=line><span class=cl><span class=c1># To push the current branch and set the remote as upstream, use</span>
</span></span><span class=line><span class=cl><span class=c1># git push --set-upstream origin image</span>
</span></span></code></pre></div><h2 id=切換分支>切換分支<a hidden class=anchor aria-hidden=true href=#切換分支>#</a></h2><p>如果要將本地分支切換到遠程分支<code>remotes/origin/image</code>，可通過如下命令實現</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># git checkout -b &lt;branch&gt; --track &lt;remote&gt;/&lt;branch&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># -b &lt;new_branch&gt;    Create a new branch named &lt;new_branch&gt; and start it at &lt;start_point&gt;;</span>
</span></span><span class=line><span class=cl><span class=c1># -t, --track     When creating a new branch, set up &#34;upstream&#34; configuration.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>git checkout -t remotes/origin/image
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 本地分支，從其它分支切換到本地分支code</span>
</span></span><span class=line><span class=cl>git checkout code
</span></span></code></pre></div><p>演示過程如下</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git branch
</span></span><span class=line><span class=cl>* code
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ git branch -a
</span></span><span class=line><span class=cl>* code
</span></span><span class=line><span class=cl>  remotes/origin/HEAD -&gt; origin/code
</span></span><span class=line><span class=cl>  remotes/origin/code
</span></span><span class=line><span class=cl>  remotes/origin/image
</span></span><span class=line><span class=cl>  remotes/origin/master
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ git checkout -t remotes/origin/image
</span></span><span class=line><span class=cl>Branch <span class=s1>&#39;image&#39;</span> <span class=nb>set</span> up to track remote branch <span class=s1>&#39;image&#39;</span> from <span class=s1>&#39;origin&#39;</span>.
</span></span><span class=line><span class=cl>  Switched to a new branch <span class=s1>&#39;image&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ git branch
</span></span><span class=line><span class=cl>  code
</span></span><span class=line><span class=cl>* image
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ git branch -a
</span></span><span class=line><span class=cl>  code
</span></span><span class=line><span class=cl>* image
</span></span><span class=line><span class=cl>  remotes/origin/HEAD -&gt; origin/code
</span></span><span class=line><span class=cl>  remotes/origin/code
</span></span><span class=line><span class=cl>  remotes/origin/image
</span></span><span class=line><span class=cl>  remotes/origin/master
</span></span></code></pre></div><p>此處遠程默認分支爲<code>code</code>，如果需要更改爲<code>master</code>，執行如下命令</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># change HEAD from origin/code to origin/master</span>
</span></span><span class=line><span class=cl>git remote set-head origin master
</span></span></code></pre></div><h2 id=刪除分支>刪除分支<a hidden class=anchor aria-hidden=true href=#刪除分支>#</a></h2><p>可分爲刪除遠程分支、本地分支、追蹤分支三種情況，具體見<a href=https://stackoverflow.com/questions/2003505/how-do-i-delete-a-git-branch-both-locally-and-remotely#answer-23961231>How do I delete a Git branch both locally and remotely?</a>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1 - 刪除遠程分支</span>
</span></span><span class=line><span class=cl>$ git push origin --delete &lt;branch&gt; <span class=c1># Git version 1.7.0 or newer</span>
</span></span><span class=line><span class=cl>$ git push origin :&lt;branch&gt; <span class=c1># Git versions older than 1.7.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2 - 刪除本地分支</span>
</span></span><span class=line><span class=cl>$ git branch --delete &lt;branch&gt;
</span></span><span class=line><span class=cl>$ git branch -d &lt;branch&gt; <span class=c1># Shorter version</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ git branch -D &lt;branch&gt; <span class=c1># Force delete un-merged branches</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># error: The branch &#39;image&#39; is not fully merged.</span>
</span></span><span class=line><span class=cl><span class=c1># If you are sure you want to delete it, run &#39;git branch -D image&#39;.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3 - 刪除本地追蹤分支</span>
</span></span><span class=line><span class=cl>$ git branch --delete --remotes &lt;remote&gt;/&lt;branch&gt;
</span></span><span class=line><span class=cl>$ git branch -dr &lt;remote&gt;/&lt;branch&gt; <span class=c1># Shorter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ git fetch &lt;remote&gt; --prune <span class=c1># Delete multiple obsolete tracking branches</span>
</span></span><span class=line><span class=cl>$ git fetch &lt;remote&gt; -p <span class=c1># Shorter</span>
</span></span></code></pre></div><h2 id=travis-ci-配置>Travis CI 配置<a hidden class=anchor aria-hidden=true href=#travis-ci-配置>#</a></h2><p>[Travis CI][travisci]官方說明文檔 [GitHub Pages Deployment][travisci-github-page]。</p><h2 id=生成-github-訪問-token>生成 Github 訪問 Token<a hidden class=anchor aria-hidden=true href=#生成-github-訪問-token>#</a></h2><blockquote><p>You’ll need to generate a <a href=https://help.github.com/articles/creating-an-access-token-for-command-line-use/>personal access token</a> with the public_repo or repo scope (repo is required for private repositories). Since the token should be private, you’ll want to pass it to Travis securely in your <a href=https://docs.travis-ci.com/user/environment-variables#Defining-Variables-in-Repository-Settings>repository settings</a> or via <a href=https://docs.travis-ci.com/user/environment-variables#Defining-encrypted-variables-in-.travis.yml>encrypted variables</a> in .travis.yml.</p></blockquote><p>在Github的<a href=https://github.com/settings/tokens>Developer settings</a>頁面中生成<code>personal access tokens</code>，若是私有倉庫，勾選<code>repo</code>；若是公開倉庫，勾選<code>public_repo</code>。此處本人選擇了 <code>public_repo</code>, <code>repo:status</code>, <code>repo_deployment</code>三項。</p><p>生成的是長度爲<code>40</code>的隨機字符串，注意請勿泄漏。</p><p><img loading=lazy src=/images/github-access-token.png></p><h2 id=設置環境變量>設置環境變量<a hidden class=anchor aria-hidden=true href=#設置環境變量>#</a></h2><p>生成的<code>token</code>須在[Travis CI][travisci]的目標Repo中設置，頁面地址爲 <a href=https://travis-ci.org/MaxdSre/maxdsre.github.io/settings>https://travis-ci.org/MaxdSre/maxdsre.github.io/settings</a>。</p><p><img loading=lazy src=/images/travisci-system-var-setting.png></p><p>確保<code>General</code>中的<code>Build only if .travis.yml is present</code>, <code>Build pushed branches</code>, <code>Build pushed pull requests</code>已啓用。</p><p><img loading=lazy src=/images/travisci-general-setting.png></p><p>官方文檔[GitHub Pages Deployment][travisci-github-page]定義的默認<code>token</code>名爲<code>GITHUB_TOKEN</code>，其它指令詳見文檔。</p><blockquote><p>Notice that the values are not escaped when your builds are executed. Special characters (for bash) should be escaped accordingly.</p></blockquote><p>此處定義相關變量，稍後會寫入<code>.travis.yml</code>文件。</p><table><thead><tr><th>Environment Variables</th><th>Value</th></tr></thead><tbody><tr><td>CNAME_URL</td><td>axdlog.com</td></tr><tr><td>GITHUB_USERNAME</td><td>MaxdSre</td></tr><tr><td>GITHUB_EMAIL</td><td><a href=mailto:admin@axdlog.com>admin@axdlog.com</a> (假設值)</td></tr><tr><td>GITHUB_TOKEN</td><td>75e8b72618ebf48df0b235cp4affd79e167b2489 (假設值)</td></tr></tbody></table><h2 id=travisyml-指令>.travis.yml 指令<a hidden class=anchor aria-hidden=true href=#travisyml-指令>#</a></h2><p>[Hugo][hugo]是用Golang構建的，如果在<code>.travis.yml</code>中使用<code>language: go</code>，[Travis CI][travisci]構建Golang環境耗時太長(數分鐘)。</p><p><del>看到他人教程中有用Python的，恰巧最近在學習Python，便選擇Python做爲構建環境。因[Travis CI][travisci]的容器環境是基於Ubuntu的，故可以使用<code>dpkg</code>、<code>apt-get</code>等命令，但需要添加<code>sudo</code></del>。</p><p>使用Python經常出現構建失敗的情況，原因是GitHub禁止Travis容器的HTTP請求，通過<code>tor</code>代理解決。</p><p>最終指令如下</p><h3 id=python>Python<a hidden class=anchor aria-hidden=true href=#python>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=c># https://docs.travis-ci.com/user/deployment/pages/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># https://docs.travis-ci.com/user/reference/xenial/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># https://docs.travis-ci.com/user/languages/python/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># https://docs.travis-ci.com/user/customizing-the-build/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>dist</span><span class=p>:</span><span class=w> </span><span class=l>xenial</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>language</span><span class=p>:</span><span class=w> </span><span class=l>python</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>python</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=s2>&#34;3.7&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>before_install</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>sudo apt-get update -qq</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>sudo apt-get -yq install apt-transport-https tor curl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># install - install any dependencies required</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>install</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># install latest release version</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># Github may forbid request from travis container, so use tor proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sudo systemctl start tor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># - curl -fsL --socks5-hostname 127.0.0.1:9050 https://api.github.com/repos/gohugoio/hugo/releases/latest | sed -r -n &#39;/browser_download_url/{/Linux-64bit.deb/{s@[^:]*:[[:space:]]*&#34;([^&#34;]*)&#34;.*@\1@g;p;q}}&#39; | xargs wget</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>download_command=&#39;curl -fsSL -x socks5h://127.0.0.1:9050&#39;</span><span class=w> </span><span class=c># --socks5-hostname</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>$download_command -O $($download_command https://api.github.com/repos/gohugoio/hugo/releases/latest | sed -r -n &#39;/browser_download_url/{/Linux-64bit.deb/{s@[^:]*:[[:space:]]*&#34;([^&#34;]*)&#34;.*@\1@g;p;q}}&#39;)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sudo dpkg -i hugo*.deb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>rm -rf public 2&gt; /dev/null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># script - run the build script</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>hugo 2&gt; /dev/null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;$CNAME_URL&#34; &gt; public/CNAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class=l>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>skip-cleanup</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>github-token</span><span class=p>:</span><span class=w> </span><span class=l>$GITHUB_TOKEN </span><span class=w> </span><span class=c># Set in travis-ci.org dashboard, marked secure</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>email</span><span class=p>:</span><span class=w> </span><span class=l>$GITHUB_EMAIL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>$GITHUB_USERNAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>verbose</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>keep-history</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>local-dir</span><span class=p>:</span><span class=w> </span><span class=l>public</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>target_branch</span><span class=p>:</span><span class=w> </span><span class=l>master </span><span class=w> </span><span class=c># branch contains blog content</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branch</span><span class=p>:</span><span class=w> </span><span class=l>code </span><span class=w> </span><span class=c># branch contains Hugo generator code</span><span class=w>
</span></span></span></code></pre></div><h3 id=golang-deprecated>Golang (deprecated)<a hidden class=anchor aria-hidden=true href=#golang-deprecated>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=c># https://docs.travis-ci.com/user/deployment/pages/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># https://docs.travis-ci.com/user/reference/xenial/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># https://docs.travis-ci.com/user/languages/go/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># https://docs.travis-ci.com/user/customizing-the-build/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>dist</span><span class=p>:</span><span class=w> </span><span class=l>xenial</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>language</span><span class=p>:</span><span class=w> </span><span class=l>go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>go</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># before_install</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># install - install any dependencies required</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>install</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>go get github.com/gohugoio/hugo   </span><span class=w> </span><span class=c># consume time 70.85s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>before_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>rm -rf public 2&gt; /dev/null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># script - run the build script</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>hugo 2&gt; /dev/null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;$CNAME_URL&#34; &gt; public/CNAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class=l>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>skip-cleanup</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>github-token</span><span class=p>:</span><span class=w> </span><span class=l>$GITHUB_TOKEN </span><span class=w> </span><span class=c># Set in travis-ci.org dashboard, marked secure</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>email</span><span class=p>:</span><span class=w> </span><span class=l>$GITHUB_EMAIL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>$GITHUB_USERNAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>verbose</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>keep-history</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>local-dir</span><span class=p>:</span><span class=w> </span><span class=l>public</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>target_branch</span><span class=p>:</span><span class=w> </span><span class=l>master </span><span class=w> </span><span class=c># branch contains blog content</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branch</span><span class=p>:</span><span class=w> </span><span class=l>code </span><span class=w> </span><span class=c># branch contains Hugo generator code</span><span class=w>
</span></span></span></code></pre></div><p>將指令寫入到文件<code>.travis.yml</code>中，並將該<code>.travis.yml</code>上傳至repo的<code>code</code>分支中。</p><h2 id=持續集成>持續集成<a hidden class=anchor aria-hidden=true href=#持續集成>#</a></h2><p>所有操作完成後，只需將需要發佈的Blog上傳到repo的<code>code</code>分支中，[Travis CI][travisci]會自動進行部署操作，將更新的Blog內容更新到repo的<code>master</code>分支中，實現Blog的持續集成，自動部署。</p><p><img loading=lazy src=/images/travisci-deploy-status.png></p><p>部署過程日誌</p><p><img loading=lazy src=/images/travisci-deploy-log-1.png></p><p><img loading=lazy src=/images/travisci-deploy-log-2.png></p><h2 id=參考資料>參考資料<a hidden class=anchor aria-hidden=true href=#參考資料>#</a></h2><ul><li><a href=https://jellis18.github.io/post/2017-12-03-continuous-integration-hugo/>Continuous Integration of Hugo Website using Travis CI and Github</a></li><li><a href=https://github.com/ldez/travis-continuous-delivery-hugo-deploy>Travis continuous delivery</a></li><li><a href=https://medium.com/zendesk-engineering/how-to-create-a-website-like-freshswift-net-using-hugo-travis-ci-and-github-pages-67be6f480298>How to create a website like freshswift.net using Hugo, Travis CI, and GitHub Pages</a></li><li><a href=https://www.leowkahman.com/2017/09/10/gitlab-ci-remove-priority-zero-from-hugo-sitemap/>GitLab CI remove priority zero from Hugo sitemap</a></li><li><a href=https://leonidboykov.com/post/hugo-github-travis/>Deploy Hugo site to Github Pages with Travis CI</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://567899.xyz/tags/hugo/>Hugo</a></li><li><a href=https://567899.xyz/tags/github/>Github</a></li></ul><nav class=paginav><a class=prev href=https://567899.xyz/post/wireguard-service-install/><span class=title>« 上一页</span><br><span>手动配置安装WireGuard服务端</span>
</a><a class=next href=https://567899.xyz/post/lycamobile-activation-recharge-close-voice-mail/><span class=title>下一页 »</span><br><span>美国SIM实体电话卡Lycamobile激活充值关闭语音信箱</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 利用Travis CI和Hugo將Blog自動部署到Github Pages on x" href="https://x.com/intent/tweet/?text=%e5%88%a9%e7%94%a8Travis%20CI%e5%92%8cHugo%e5%b0%87Blog%e8%87%aa%e5%8b%95%e9%83%a8%e7%bd%b2%e5%88%b0Github%20Pages&amp;url=https%3a%2f%2f567899.xyz%2fpost%2fhugo-travis-ci-deploy-github-pages-automatically%2f&amp;hashtags=Hugo%2cGitHub"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 利用Travis CI和Hugo將Blog自動部署到Github Pages on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f567899.xyz%2fpost%2fhugo-travis-ci-deploy-github-pages-automatically%2f&amp;title=%e5%88%a9%e7%94%a8Travis%20CI%e5%92%8cHugo%e5%b0%87Blog%e8%87%aa%e5%8b%95%e9%83%a8%e7%bd%b2%e5%88%b0Github%20Pages&amp;summary=%e5%88%a9%e7%94%a8Travis%20CI%e5%92%8cHugo%e5%b0%87Blog%e8%87%aa%e5%8b%95%e9%83%a8%e7%bd%b2%e5%88%b0Github%20Pages&amp;source=https%3a%2f%2f567899.xyz%2fpost%2fhugo-travis-ci-deploy-github-pages-automatically%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 利用Travis CI和Hugo將Blog自動部署到Github Pages on reddit" href="https://reddit.com/submit?url=https%3a%2f%2f567899.xyz%2fpost%2fhugo-travis-ci-deploy-github-pages-automatically%2f&title=%e5%88%a9%e7%94%a8Travis%20CI%e5%92%8cHugo%e5%b0%87Blog%e8%87%aa%e5%8b%95%e9%83%a8%e7%bd%b2%e5%88%b0Github%20Pages"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 利用Travis CI和Hugo將Blog自動部署到Github Pages on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f567899.xyz%2fpost%2fhugo-travis-ci-deploy-github-pages-automatically%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 利用Travis CI和Hugo將Blog自動部署到Github Pages on whatsapp" href="https://api.whatsapp.com/send?text=%e5%88%a9%e7%94%a8Travis%20CI%e5%92%8cHugo%e5%b0%87Blog%e8%87%aa%e5%8b%95%e9%83%a8%e7%bd%b2%e5%88%b0Github%20Pages%20-%20https%3a%2f%2f567899.xyz%2fpost%2fhugo-travis-ci-deploy-github-pages-automatically%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 利用Travis CI和Hugo將Blog自動部署到Github Pages on telegram" href="https://telegram.me/share/url?text=%e5%88%a9%e7%94%a8Travis%20CI%e5%92%8cHugo%e5%b0%87Blog%e8%87%aa%e5%8b%95%e9%83%a8%e7%bd%b2%e5%88%b0Github%20Pages&amp;url=https%3a%2f%2f567899.xyz%2fpost%2fhugo-travis-ci-deploy-github-pages-automatically%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 利用Travis CI和Hugo將Blog自動部署到Github Pages on ycombinator" href="https://news.ycombinator.com/submitlink?t=%e5%88%a9%e7%94%a8Travis%20CI%e5%92%8cHugo%e5%b0%87Blog%e8%87%aa%e5%8b%95%e9%83%a8%e7%bd%b2%e5%88%b0Github%20Pages&u=https%3a%2f%2f567899.xyz%2fpost%2fhugo-travis-ci-deploy-github-pages-automatically%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><div id=waline></div><script type=module>
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
    const locale = {
        nick: '昵称(必填)',
        nickError: '请填写昵称',
        mail: '邮箱',
        mailError: '请填写正确的邮件地址',
        link: '网址',
        optional: '可选',
        placeholder: '说点什么吧...\n填写邮箱可收到回复提醒。\n评论区支持 Markdown 语法及预览。\n',
        sofa: '来发评论吧~',
        submit: '提交',
        like: '喜欢',
        cancelLike: '取消喜欢',
        reply: '回复',
        cancelReply: '取消回复',
        comment: '评论',
        refresh: '刷新',
        more: '加载更多...',
        preview: '预览',
        emoji: '表情',
        uploadImage: '上传图片',
        seconds: '秒前',
        minutes: '分钟前',
        hours: '小时前',
        days: '天前',
        now: '刚刚',
        uploading: '正在上传',
        login: '登录',
        logout: '退出',
        admin: '博主',
        sticky: '置顶',
        word: '字',
        wordHint: '评论字数应在 $0 到 $1 字之间！\n当前字数：$2',
        anonymous: '匿名',
        level0: '潜水',
        level1: '冒泡',
        level2: '吐槽',
        level3: '活跃',
        level4: '话痨',
        level5: '传说',
        gif: '表情包',
        gifSearchPlaceholder: '搜索表情包',
        profile: '个人资料',
        approved: '通过',
        waiting: '待审核',
        spam: '垃圾',
        unsticky: '取消置顶',
        oldest: '按倒序',
        latest: '按正序',
        hottest: '按热度',
        reactionTitle: '你认为这篇文章怎么样？',
    };
    init({
        
        el: '#waline',
        serverURL: 'https://comments.567899.xyz',
        locale,
        emoji: true,     
        search: true,    
        reaction: false,  
        requiredMeta: ['nick'],
        pageSize: 10,
        imageUploader: true,
        copyright: true,
        pageview: true,
        like: true,
    });
</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://567899.xyz/>Xizi's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>